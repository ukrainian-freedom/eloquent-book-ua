{{meta {load_files: [¬´code/chapter/19_paint.js¬ª], zip: ¬´html include=[\¬´css/paint.css\¬ª]"}}}

# –ü—Ä–æ–µ–∫—Ç: –ü—ñ–∫—Å–µ–ª—å–Ω–∏–π —Ö—É–¥–æ–∂–Ω—ñ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä

{{quote {–∞–≤—Ç–æ—Ä: 

¬´Joan Mir√≥¬ª, chapter: true}} {{quote {author: ‚ÄúJoan Mir√≥‚Äù, chapter: true}}

–Ø –¥–∏–≤–ª—é—Å—è –Ω–∞ –±–µ–∑–ª—ñ—á –∫–æ–ª—å–æ—Ä—ñ–≤ –ø–µ—Ä–µ–¥—ñ –º–Ω–æ—é. –Ø –¥–∏–≤–ª—é—Å—è –Ω–∞ —Å–≤–æ—î —á–∏—Å—Ç–µ –ø–æ–ª–æ—Ç–Ω–æ. –ü–æ—Ç—ñ–º —è –Ω–∞–º–∞–≥–∞—é—Å—è –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –∫–æ–ª—å–æ—Ä–∏, —è–∫ —Å–ª–æ–≤–∞, —â–æ —Ñ–æ—Ä–º—É—é—Ç—å –≤—ñ—Ä—à—ñ, —è–∫ –Ω–æ—Ç–∏, —â–æ —Ñ–æ—Ä–º—É—é—Ç—å –º—É–∑–∏–∫—É.

quote}}

{{index ¬´Mir√≥, Joan¬ª, ¬´example of drawing program¬ª, ¬´project chapter¬ª}}

{{figure {url: ¬´img/chapter_picture_19.jpg¬ª, alt: ¬´–Ü–ª—é—Å—Ç—Ä–∞—Ü—ñ—è —ñ–∑ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º –º–æ–∑–∞—ó–∫–∏ –∑ —á–æ—Ä–Ω–∏—Ö –ø–ª–∏—Ç–æ–∫, –∑ –±–∞–Ω–∫–∞–º–∏ —ñ–Ω—à–∏—Ö –ø–ª–∏—Ç–æ–∫ –ø–æ—Ä—É—á¬ª, ¬ªchapter: ¬´–û–±—Ä–∞–º–ª–µ–Ω–Ω—è"}}}.

–ú–∞—Ç–µ—Ä—ñ–∞–ª –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö —Ä–æ–∑–¥—ñ–ª—ñ–≤ –¥–∞—î –≤–∞–º –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏, –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–∞–∑–æ–≤–æ–≥–æ ((–≤–µ–±-–¥–æ–¥–∞—Ç–∫—É)). –£ —Ü—ñ–π –≥–ª–∞–≤—ñ –º–∏ –∑—Ä–æ–±–∏–º–æ —Å–∞–º–µ —Ü–µ.

{{index [—Ñ–∞–π–ª, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è]}}

–ù–∞—à ((–¥–æ–¥–∞—Ç–æ–∫)) –±—É–¥–µ ((–ø—ñ–∫—Å–µ–ª—å))-((–º–∞–ª—é–Ω–æ–∫)) –ø—Ä–æ–≥—Ä–∞–º–æ—é, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—ñ–∫—Å–µ–ª—å –∑–∞ –ø—ñ–∫—Å–µ–ª–µ–º, –º–∞–Ω—ñ–ø—É–ª—é—é—á–∏ –π–æ–≥–æ –∑–±—ñ–ª—å—à–µ–Ω–∏–º –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º, –ø–æ–∫–∞–∑–∞–Ω–∏–º —É –≤–∏–≥–ª—è–¥—ñ —Å—ñ—Ç–∫–∏ –∑ –∫–æ–ª—å–æ—Ä–æ–≤–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ–≥—Ä–∞–º–∏ –º–æ–∂–Ω–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å, –º–∞–ª—é–≤–∞—Ç–∏ –Ω–∞ –Ω–∏—Ö –º–∏—à–µ—é –∞–±–æ —ñ–Ω—à–∏–º –≤–∫–∞–∑—ñ–≤–Ω–∏–º –ø—Ä–∏—Å—Ç—Ä–æ—î–º —ñ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —ó—Ö. –û—Å—å —è–∫ —Ü–µ –±—É–¥–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏:

{{figure {url: ¬´img/pixel_editor.png¬ª, alt: ¬´–°–∫—Ä—ñ–Ω—à–æ—Ç —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –ø—ñ–∫—Å–µ–ª—å–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞, –∑ —Å—ñ—Ç–∫–æ—é –∫–æ–ª—å–æ—Ä–æ–≤–∏—Ö –ø—ñ–∫—Å–µ–ª—ñ–≤ –≤–≥–æ—Ä—ñ —ñ —Ä—è–¥–æ–º –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∫–µ—Ä—É–≤–∞–Ω–Ω—è —É –≤–∏–≥–ª—è–¥—ñ HTML –ø–æ–ª—ñ–≤ —ñ –∫–Ω–æ–ø–æ–∫ –≤–Ω–∏–∑—É¬ª, width: ‚Äú8cm‚Äù}}}}

–ú–∞–ª—é–≤–∞—Ç–∏ –Ω–∞ –∫–æ–º–ø'—é—Ç–µ—Ä—ñ - —Ü–µ —á—É–¥–æ–≤–æ. –í–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ç—É—Ä–±—É–≤–∞—Ç–∏—Å—è –ø—Ä–æ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏, ((–Ω–∞–≤–∏—á–∫–∏)) –∞–±–æ —Ç–∞–ª–∞–Ω—Ç. –í–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ—á–∏–Ω–∞—î—Ç–µ –º–∞–∑–∞—Ç–∏ —ñ –±–∞—á–∏—Ç–µ, —â–æ –≤–∏–π—à–ª–æ.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

{{index drawing, ¬´select (HTML-—Ç–µ–≥)¬ª, ¬´canvas (HTML-—Ç–µ–≥)¬ª, component}}

–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≥—Ä–∞–º–∏ –ø–æ–∫–∞–∑—É—î –≤–µ–ª–∏–∫–∏–π –µ–ª–µ–º–µ–Ω—Ç `<canvas>` –∑–≤–µ—Ä—Ö—É, –∑ –∫—ñ–ª—å–∫–æ–º–∞ —Ñ–æ—Ä–º–∞–º–∏ ((–ø–æ–ª–µ)) –ø—ñ–¥ –Ω–∏–º. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞–ª—é—î –Ω–∞ ((–º–∞–ª—é–Ω–æ–∫)), –æ–±–∏—Ä–∞—é—á–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É –ø–æ–ª—ñ `<select>`, –∞ –ø–æ—Ç—ñ–º –∫–ª–∞—Ü–∞—î, ((—Ç–æ—Ä–∫–∞—î—Ç—å—Å—è)) –∞–±–æ ((–ø–µ—Ä–µ—Ç—è–≥—É—î)) –ø–æ –ø–æ–ª–æ—Ç–Ω—É. –Ü—Å–Ω—É—é—Ç—å —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö –ø—ñ–∫—Å–µ–ª—ñ–≤ –∞–±–æ –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫—ñ–≤, –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –æ–±–ª–∞—Å—Ç—ñ —Ç–∞ –≤–∏–±–æ—Ä—É –∫–æ–ª—å–æ—Ä—É –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ.

{{index [DOM, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏]}}

–ú–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —è–∫ –Ω–∏–∑–∫—É –æ–±'—î–∫—Ç—ñ–≤ _((component))s_, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –∑–∞ —á–∞—Å—Ç–∏–Ω—É DOM —ñ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–µ–±–µ —ñ–Ω—à—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏.

{{index [state, ¬´of application¬ª]}}

–°—Ç–∞–Ω –ø—Ä–æ–≥—Ä–∞–º–∏ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –≤–∏–±—Ä–∞–Ω–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É —Ç–∞ –≤–∏–±—Ä–∞–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É. –ú–∏ –Ω–∞–ª–∞—à—Ç—É—î–º–æ —Ç–∞–∫, —â–æ–± —Å—Ç–∞–Ω –∑–±–µ—Ä—ñ–≥–∞–≤—Å—è —É —î–¥–∏–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–Ω—ñ, –∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –∑–∞–≤–∂–¥–∏ –±–∞–∑—É–≤–∞–ª–∏ —Å–≤—ñ–π –≤–∏–≥–ª—è–¥ –Ω–∞ –ø–æ—Ç–æ—á–Ω–æ–º—É —Å—Ç–∞–Ω—ñ.

–©–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —á–æ–º—É —Ü–µ –≤–∞–∂–ª–∏–≤–æ, –¥–∞–≤–∞–π—Ç–µ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ–≤ —Å—Ç–∞–Ω—É –ø–æ –≤—Å—å–æ–º—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É. –î–æ –ø–µ–≤–Ω–æ–≥–æ –º–æ–º–µ–Ω—Ç—É —Ü–µ –ª–µ–≥—à–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞—Ç–∏. –ú–∏ –º–æ–∂–µ–º–æ –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞—Ç–∏ ((–ø–æ–ª–µ –∫–æ–ª—å–æ—Ä—É)) —ñ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –π–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è, –∫–æ–ª–∏ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –ø–æ—Ç–æ—á–Ω–∏–π –∫–æ–ª—ñ—Ä.

–ê–ª–µ –ø–æ—Ç—ñ–º –º–∏ –¥–æ–¥–∞—î–º–æ ((–ø—ñ–ø–µ—Ç–∫—É –∫–æ–ª—å–æ—Ä—É)) - —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∫–ª–∞—Ü–Ω—É—Ç–∏ –ø–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—é, —â–æ–± –≤–∏–±—Ä–∞—Ç–∏ –∫–æ–ª—ñ—Ä –ø–µ–≤–Ω–æ–≥–æ –ø—ñ–∫—Å–µ–ª—è. –©–æ–± –∫–æ–ª—ñ—Ä–Ω–µ –ø–æ–ª–µ –ø–æ–∫–∞–∑—É–≤–∞–ª–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–æ–ª—ñ—Ä, —Ü–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–≤–∏–Ω–µ–Ω –∑–Ω–∞—Ç–∏, —â–æ –∫–æ–ª—ñ—Ä–Ω–µ –ø–æ–ª–µ —ñ—Å–Ω—É—î, —ñ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –π–æ–≥–æ —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ –≤—ñ–Ω –≤–∏–±–∏—Ä–∞—î –Ω–æ–≤–∏–π –∫–æ–ª—ñ—Ä. –Ø–∫—â–æ –≤–∏ –∫–æ–ª–∏-–Ω–µ–±—É–¥—å –¥–æ–¥–∞—Å—Ç–µ —ñ–Ω—à–µ –º—ñ—Å—Ü–µ, —è–∫–µ —Ä–æ–±–∏—Ç—å –∫–æ–ª—ñ—Ä –≤–∏–¥–∏–º–∏–º (–º–æ–∂–ª–∏–≤–æ, –∫—É—Ä—Å–æ—Ä –º–∏—à—ñ –º–æ–∂–µ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –π–æ–≥–æ), –≤–∞–º –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –æ–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥ –∑–º—ñ–Ω–∏ –∫–æ–ª—å–æ—Ä—É, —â–æ–± –≤—ñ–Ω —Ç–∞–∫–æ–∂ –±—É–≤ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–∏–π.

{–ú–æ–¥—É–ª—å–Ω—ñ—Å—Ç—å —ñ–Ω–¥–µ–∫—Å—ñ–≤

–ü–æ —Å—É—Ç—ñ, —Ü–µ —Å—Ç–≤–æ—Ä—é—î –ø—Ä–æ–±–ª–µ–º—É, –∫–æ–ª–∏ –∫–æ–∂–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –ø–æ–≤–∏–Ω–Ω–∞ –∑–Ω–∞—Ç–∏ –ø—Ä–æ –≤—Å—ñ —ñ–Ω—à—ñ —á–∞—Å—Ç–∏–Ω–∏, —â–æ –Ω–µ —î –¥—É–∂–µ –º–æ–¥—É–ª—å–Ω–∏–º. –î–ª—è –Ω–µ–≤–µ–ª–∏–∫–∏—Ö –ø—Ä–æ–≥—Ä–∞–º, –ø–æ–¥—ñ–±–Ω–∏—Ö –¥–æ —Ç—ñ—î—ó, —â–æ –æ–ø–∏—Å–∞–Ω–æ —É —Ü—ñ–π –≥–ª–∞–≤—ñ, —Ü–µ –º–æ–∂–µ –Ω–µ –±—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º–æ—é. –î–ª—è –≤–µ–ª–∏–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç—ñ–≤ —Ü–µ –º–æ–∂–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏—Å—è –Ω–∞ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –∫–æ—à–º–∞—Ä.

–©–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ —Ü—å–æ–≥–æ –∫–æ—à–º–∞—Ä—É –≤ –ø—Ä–∏–Ω—Ü–∏–ø—ñ, –º–∏ –±—É–¥–µ–º–æ —Å—É–≤–æ—Ä–æ –¥–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è _((–ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö))_. –Ñ —Å—Ç–∞–Ω, —ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–∞–ª—é—î—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ü—å–æ–≥–æ —Å—Ç–∞–Ω—É. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –º–æ–∂–µ —Ä–µ–∞–≥—É–≤–∞—Ç–∏ –Ω–∞ –¥—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –æ–Ω–æ–≤–ª—é—é—á–∏ —Å—Ç–∞–Ω, —ñ —Ç–æ–¥—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏ —Å–µ–±–µ –∑ —Ü–∏–º –Ω–æ–≤–∏–º —Å—Ç–∞–Ω–æ–º.

{{—ñ–Ω–¥–µ–∫—Å–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞, —Ñ—Ä–µ–π–º–≤–æ—Ä–∫}}

–ù–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ, –∫–æ–∂–µ–Ω ((–∫–æ–º–ø–æ–Ω–µ–Ω—Ç)) –Ω–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è —Ç–∞–∫, —â–æ –∫–æ–ª–∏ –π–æ–º—É –Ω–∞–¥–∞—î—Ç—å—Å—è –Ω–æ–≤–∏–π —Å—Ç–∞–Ω, –≤—ñ–Ω —Ç–∞–∫–æ–∂ –ø–æ–≤—ñ–¥–æ–º–ª—è—î –ø—Ä–æ —Ü–µ —Å–≤–æ—ó –¥–æ—á—ñ—Ä–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —è–∫—â–æ —Ç—ñ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ü—å–æ–≥–æ —î –¥–µ—â–æ –∫–ª–æ–ø—ñ—Ç–∫–æ—é —Å–ø—Ä–∞–≤–æ—é. –ó—Ä–æ–±–∏—Ç–∏ —Ü–µ –∑—Ä—É—á–Ω—ñ—à–∏–º - –æ—Å–Ω–æ–≤–Ω–∞ –ø–µ—Ä–µ–≤–∞–≥–∞ –±–∞–≥–∞—Ç—å–æ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –¥–ª—è –±—Ä–∞—É–∑–µ—Ä—ñ–≤. –ê–ª–µ –¥–ª—è —Ç–∞–∫–æ–≥–æ –Ω–µ–≤–µ–ª–∏–∫–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É, —è–∫ —Ü–µ–π, –º–∏ –º–æ–∂–µ–º–æ –æ–±—ñ–π—Ç–∏—Å—è –±–µ–∑ —Ç–∞–∫–æ—ó —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏.

{{index [state, transitions]}}

–û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—å—Å—è —É –≤–∏–≥–ª—è–¥—ñ –æ–±'—î–∫—Ç—ñ–≤, —è–∫—ñ –º–∏ –±—É–¥–µ–º–æ –Ω–∞–∑–∏–≤–∞—Ç–∏ _((action))s_. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –º–æ–∂—É—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ç–∞–∫—ñ –¥—ñ—ó —ñ _((–≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏))_ —ó—Ö - –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ñ–π —Ñ—É–Ω–∫—Ü—ñ—ó —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–∞–Ω–æ–º. –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –æ–±—á–∏—Å–ª—é—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å—Ç–∞–Ω, –ø—ñ—Å–ª—è —á–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è –¥–æ —Ü—å–æ–≥–æ –Ω–æ–≤–æ–≥–æ —Å—Ç–∞–Ω—É.

{{index [DOM, components]}}

–ú–∏ –±–µ—Ä–µ–º–æ –Ω–∞ —Å–µ–±–µ –±—Ä—É–¥–Ω—É –∑–∞–¥–∞—á—É –∑–∞–ø—É—Å–∫—É ((–∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É)) —ñ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –¥–æ –Ω—å–æ–≥–æ ((—Å—Ç—Ä—É–∫—Ç—É—Ä–∏)). –•–æ—á–∞ —á–∞—Å—Ç–∏–Ω–∏, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ DOM, –≤—Å–µ —â–µ –ø–æ–≤–Ω—ñ ((–ø–æ–±—ñ—á–Ω–∏—Ö –µ—Ñ–µ–∫—Ç—ñ–≤)), –≤–æ–Ω–∏ —Ç—Ä–∏–º–∞—é—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–º—É –∫—ñ—Å—Ç—è–∫—É: —Ü–∏–∫–ª—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É. –°—Ç–∞–Ω –≤–∏–∑–Ω–∞—á–∞—î, —è–∫ –≤–∏–≥–ª—è–¥–∞—î DOM, —ñ —î–¥–∏–Ω–∏–π —Å–ø–æ—Å—ñ–±, —É —è–∫–∏–π –ø–æ–¥—ñ—ó DOM –º–æ–∂—É—Ç—å –∑–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞–Ω, - —Ü–µ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –¥—ñ—ó –¥–æ —Å—Ç–∞–Ω—É.

{{index ¬´data flow¬ª}}

–Ü—Å–Ω—É—î _–±–∞–≥–∞—Ç–æ_ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Ü—å–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É, –∫–æ–∂–µ–Ω –∑ —è–∫–∏—Ö –º–∞—î —Å–≤–æ—ó –ø–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –ø—Ä–æ–±–ª–µ–º–∏, –∞–ª–µ —ó—Ö —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞ —ñ–¥–µ—è –æ–¥–Ω–∞–∫–æ–≤–∞: –∑–º—ñ–Ω–∏ —Å—Ç–∞–Ω—É –ø–æ–≤–∏–Ω–Ω—ñ –ø—Ä–æ—Ö–æ–¥–∏—Ç–∏ —á–µ—Ä–µ–∑ –æ–¥–∏–Ω —á—ñ—Ç–∫–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∏–π –∫–∞–Ω–∞–ª, –∞ –Ω–µ –≤—ñ–¥–±—É–≤–∞—Ç–∏—Å—è –ø–æ–≤—Å—é–¥–Ω–æ.

{{index ¬´dom property¬ª, [interface, object]}}

–ù–∞—à—ñ ((–∫–æ–º–ø–æ–Ω–µ–Ω—Ç))–∏ –±—É–¥—É—Ç—å ((–∫–ª–∞—Å))–∞–º–∏, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É. –á—Ö–Ω—å–æ–º—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É –Ω–∞–¥–∞—î—Ç—å—Å—è —Å—Ç–∞–Ω - —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤–Ω–∏–º —Å—Ç–∞–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–∏ –∞–±–æ –º–µ–Ω—à–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º, —è–∫—â–æ –π–æ–º—É –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—å–æ–≥–æ - —ñ –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –π–æ–≥–æ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ `dom`. –¶–µ –µ–ª–µ–º–µ–Ω—Ç DOM, —è–∫–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –∫–æ–º–ø–æ–Ω–µ–Ω—Ç. –ë—ñ–ª—å—à—ñ—Å—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ñ–≤ —Ç–∞–∫–æ–∂ –ø—Ä–∏–π–º–∞—é—Ç—å –¥–µ—è–∫—ñ —ñ–Ω—à—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫—ñ –Ω–µ –∑–º—ñ–Ω—é—é—Ç—å—Å—è –∑ —á–∞—Å–æ–º, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫—É –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è ((–≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è)) –¥—ñ—ó.

{{index ¬´syncState method¬ª}}

–ö–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–∞—î –º–µ—Ç–æ–¥ syncState, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –π–æ–≥–æ –∑ –Ω–æ–≤–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º —Å—Ç–∞–Ω—É. –ú–µ—Ç–æ–¥ –æ—Ç—Ä–∏–º—É—î –æ–¥–∏–Ω –∞—Ä–≥—É–º–µ–Ω—Ç, —Å—Ç–∞–Ω, —è–∫–∏–π –º–∞—î —Ç–æ–π —Å–∞–º–∏–π —Ç–∏–ø, —â–æ —ñ –ø–µ—Ä—à–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç –π–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞.

## –°—Ç–∞–Ω

{{—ñ–Ω–¥–µ–∫—Å ¬´–∫–ª–∞—Å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è¬ª, ¬´–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è¬ª, ¬´–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞¬ª, ¬´–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –∫–æ–ª—å–æ—Ä—É¬ª}}

–°—Ç–∞–Ω –ø—Ä–æ–≥—Ä–∞–º–∏ –±—É–¥–µ –æ–±'—î–∫—Ç–æ–º –∑ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—è–º–∏ `picture`, `tool` —Ç–∞ `color`. –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å–∞–º–µ –ø–æ —Å–æ–±—ñ —î –æ–±'—î–∫—Ç–æ–º, —è–∫–∏–π –∑–±–µ—Ä—ñ–≥–∞—î —à–∏—Ä–∏–Ω—É, –≤–∏—Å–æ—Ç—É —Ç–∞ –ø—ñ–∫—Å–µ–ª—å–Ω–∏–π –≤–º—ñ—Å—Ç –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è. –ü—ñ–∫—Å–µ–ª—ñ ((pixel)) –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É —î–¥–∏–Ω–æ–º—É –º–∞—Å–∏–≤—ñ, —Ä—è–¥–æ–∫ –∑–∞ —Ä—è–¥–∫–æ–º, –∑–≤–µ—Ä—Ö—É –≤–Ω–∏–∑.

```{includeCode: true}
class Picture {
  constructor(width, height, pixels) {
    this.width = width
    this.height = height
    this.pixels = pixels;
  }
  static empty(width, height, color) {
    let pixels = new Array(width * height).fill(color);
    return new Picture(width, height, pixels);
  }
  pixel(x, y) {
    return this.pixels[x + y * this.width];
  }
  draw(pixels) {
    let copy = this.pixels.slice();
    for (let {x, y, color} of pixels) {
      copy[x + y * this.width] = color;
    }
    return new Picture(this.width, this.height, copy);
  }
}
```

{{index ¬´side effect¬ª, ¬´persistent data structure¬ª}}

–ú–∏ —Ö–æ—á–µ–º–æ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ–±—Ä–æ–±–ª—è—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —è–∫ ((–Ω–µ–∑–º—ñ–Ω–Ω–µ)) –∑–Ω–∞—á–µ–Ω–Ω—è, –∑ –ø—Ä–∏—á–∏–Ω, –¥–æ —è–∫–∏—Ö –º–∏ –ø–æ–≤–µ—Ä–Ω–µ–º–æ—Å—è –ø—ñ–∑–Ω—ñ—à–µ —É —Ü—ñ–π –≥–ª–∞–≤—ñ. –ê–ª–µ —ñ–Ω–æ–¥—ñ –Ω–∞–º —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–∏—Ç–∏ —Ü—ñ–ª—É –≥—Ä—É–ø—É –ø—ñ–∫—Å–µ–ª—ñ–≤ –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑. –î–ª—è —Ü—å–æ–≥–æ —É –∫–ª–∞—Å—ñ –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–æ –º–µ—Ç–æ–¥ `draw`, —è–∫–∏–π –æ—á—ñ–∫—É—î –º–∞—Å–∏–≤ –æ–Ω–æ–≤–ª–µ–Ω–∏—Ö –ø—ñ–∫—Å–µ–ª—ñ–≤ - –æ–±'—î–∫—Ç—ñ–≤ –∑ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—è–º–∏ `x`, `y` —Ç–∞ `color` - —ñ —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–∏–º–∏ –ø—ñ–∫—Å–µ–ª—è–º–∏. –¶–µ–π –º–µ—Ç–æ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `slice` –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –≤—Å—å–æ–≥–æ –º–∞—Å–∏–≤—É –ø—ñ–∫—Å–µ–ª—ñ–≤ - –ø–æ—á–∞—Ç–æ–∫ –∑—Ä—ñ–∑—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–æ—Ä—ñ–≤–Ω—é—î 0, –∞ –∫—ñ–Ω–µ—Ü—å - –¥–æ–≤–∂–∏–Ω—ñ –º–∞—Å–∏–≤—É.

{{—ñ–Ω–¥–µ–∫—Å ¬´–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–∞—Å–∏–≤—É¬ª, ¬´–º–µ—Ç–æ–¥ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è¬ª, [¬´–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –¥–æ–≤–∂–∏–Ω–∏¬ª, ¬´–¥–ª—è –º–∞—Å–∏–≤—É¬ª], [–º–∞—Å–∏–≤, —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è]}}

–ú–µ—Ç–æ–¥ `empty` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–≤—ñ —á–∞—Å—Ç–∏–Ω–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –º–∞—Å–∏–≤—É, —è–∫—ñ –º–∏ –Ω–µ –±–∞—á–∏–ª–∏ —Ä–∞–Ω—ñ—à–µ. –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `Array` –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –∑ —á–∏—Å–ª–æ–º –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—Ä–æ–∂–Ω—å–æ–≥–æ –º–∞—Å–∏–≤—É –∑–∞–¥–∞–Ω–æ—ó –¥–æ–≤–∂–∏–Ω–∏. –ú–µ—Ç–æ–¥ `fill` –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ü—å–æ–≥–æ –º–∞—Å–∏–≤—É –∑–∞–¥–∞–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º. –¶—ñ –º–µ—Ç–æ–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Å–∏–≤—É, —É —è–∫–æ–º—É –≤—Å—ñ –ø—ñ–∫—Å–µ–ª—ñ –º–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤–∏–π –∫–æ–ª—ñ—Ä.

{{—ñ–Ω–¥–µ–∫—Å ¬´—à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–µ —á–∏—Å–ª–æ¬ª, ¬´–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–æ–ª—å–æ—Ä—É¬ª, ¬´–ø–æ–ª–µ –∫–æ–ª—å–æ—Ä—É¬ª, ¬´–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å fillStyle¬ª}}

–ö–æ–ª—å–æ—Ä–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É –≤–∏–≥–ª—è–¥—ñ —Ä—è–¥–∫—ñ–≤, —â–æ –º—ñ—Å—Ç—è—Ç—å —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω—ñ ((CSS)) ((–∫–æ–¥ –∫–æ–ª—å–æ—Ä—É)), —è–∫—ñ —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –∑ ((—Ö–µ—à-–∑–Ω–∞–∫)) (`#`) —Ç–∞ —à–µ—Å—Ç–∏ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏—Ö (–æ—Å–Ω–æ–≤–∞ 16) —Ü–∏—Ñ—Ä - –¥–≤—ñ –¥–ª—è ((—á–µ—Ä–≤–æ–Ω–æ–≥–æ)) –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –¥–≤—ñ –¥–ª—è ((–∑–µ–ª–µ–Ω–æ–≥–æ)) –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Ç–∞ –¥–≤—ñ –¥–ª—è ((—Å–∏–Ω—å–æ–≥–æ)) –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞. –¶–µ –¥–µ—â–æ –∑–∞–≥–∞–¥–∫–æ–≤–∏–π —ñ –Ω–µ–∑—Ä—É—á–Ω–∏–π —Å–ø–æ—Å—ñ–± –∑–∞–ø–∏—Å—É –∫–æ–ª—å–æ—Ä—ñ–≤, –∞–ª–µ —Å–∞–º–µ —Ç–∞–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É –ø–æ–ª—ñ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ–ª—å–æ—Ä—ñ–≤ HTML, —ñ –π–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —É –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ `fillStyle` –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –º–∞–ª—é–≤–∞–Ω–Ω—è –ø–æ–ª–æ—Ç–Ω–∞, —Ç–æ–º—É –¥–ª—è —Å–ø–æ—Å–æ–±—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ–ª—å–æ—Ä—ñ–≤ —É —Ü—ñ–π –ø—Ä–æ–≥—Ä–∞–º—ñ –≤—ñ–Ω —î –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø—Ä–∞–∫—Ç–∏—á–Ω–∏–º.

{{index black}}

–ß–æ—Ä–Ω–∏–π, –¥–µ –≤—Å—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –¥–æ—Ä—ñ–≤–Ω—é—é—Ç—å –Ω—É–ª—é, –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è `¬´#000000¬ª`, –∞ —è—Å–∫—Ä–∞–≤–∏–π ((—Ä–æ–∂–µ–≤–∏–π)) –≤–∏–≥–ª—è–¥–∞—î —è–∫ `¬´#ff00ff¬ª`, –¥–µ —á–µ—Ä–≤–æ–Ω–∞ —ñ —Å–∏–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –º–∞—é—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è 255, –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è `ff` —É —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ —á–∏—Å–ª–µ–Ω–Ω—è ((—Ü–∏—Ñ—Ä–∞)) (—è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î _a_ –¥–æ _f_ –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —Ü–∏—Ñ—Ä –≤—ñ–¥ 10 –¥–æ 15).

{{index [—Å—Ç–∞–Ω, –ø–µ—Ä–µ—Ö–æ–¥–∏]}}

–ú–∏ –¥–æ–∑–≤–æ–ª–∏–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É ((dispatch)) ((action))s —è–∫ –æ–±'—î–∫—Ç–∏, –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ —è–∫–∏—Ö –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É—é—Ç—å –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Å—Ç–∞–Ω—É. –ü–æ–ª–µ –∫–æ–ª—å–æ—Ä—É, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–º—ñ–Ω—é—î –π–æ–≥–æ, –º–æ–∂–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –æ–±'—î–∫—Ç –Ω–∞ –∫—à—Ç–∞–ª—Ç `{color: field.value}`, –∑ —è–∫–æ–≥–æ —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–∂–µ –æ–±—á–∏—Å–ª–∏—Ç–∏ –Ω–æ–≤–∏–π —Å—Ç–∞–Ω.

{{index ¬´updateState function¬ª}}

```{includeCode: true}
function updateState(state, action) {
  return {...state, ...action};
}
```

{{index ¬´—Å–∏–º–≤–æ–ª –∫—Ä–∞–ø–∫–∏¬ª}}

–¶–µ–π –ø–∞—Ç–µ—Ä–Ω, –≤ —è–∫–æ–º—É –æ–±'—î–∫—Ç ((spread)) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ç–æ–≥–æ, —â–æ–± —Å–ø–æ—á–∞—Ç–∫—É –¥–æ–¥–∞—Ç–∏ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –¥–æ —ñ—Å–Ω—É—é—á–æ–≥–æ –æ–±'—î–∫—Ç—É, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–∏—Ç–∏ –¥–µ—è–∫—ñ –∑ –Ω–∏—Ö, —î –ø–æ—à–∏—Ä–µ–Ω–∏–º –≤ JavaScript –∫–æ–¥—ñ, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –æ–±'—î–∫—Ç–∏ ((immutable)).

## –°—Ç–≤–æ—Ä–µ–Ω–Ω—è DOM

{{index ¬´createElement method¬ª, ¬´elt function¬ª, [DOM, construction]}}

–û–¥–Ω—ñ—î—é –∑ –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ä–µ—á–µ–π, —è–∫—ñ —Ä–æ–±–ª—è—Ç—å —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ DOM. –ú–∏ –∑–Ω–æ–≤—É –∂ —Ç–∞–∫–∏ –Ω–µ —Ö–æ—á–µ–º–æ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è —Ü—å–æ–≥–æ –±–∞–≥–∞—Ç–æ—Å–ª—ñ–≤–Ω—ñ –º–µ—Ç–æ–¥–∏ DOM, —Ç–æ–º—É –ø—Ä–æ–ø–æ–Ω—É—î–º–æ –¥–µ—â–æ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –≤–µ—Ä—Å—ñ—é —Ñ—É–Ω–∫—Ü—ñ—ó `elt`:

```{includeCode: true}
function elt(type, props, ...children) {
  let dom = document.createElement(type);
  if (props) Object.assign(dom, props);
  for (let child of children) {
    if (typeof child != ¬´string¬ª) dom.appendChild(child);
    else dom.appendChild(document.createTextNode(child));
  }
  return dom;
}
```

{{index ¬´–º–µ—Ç–æ–¥ setAttribute¬ª, ¬´–∞—Ç—Ä–∏–±—É—Ç¬ª, ¬´–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å onclick¬ª, ¬´–ø–æ–¥—ñ—è –∫–ª—ñ–∫—É¬ª, ¬´–æ–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ—ó¬ª}}

–û—Å–Ω–æ–≤–Ω–∞ –≤—ñ–¥–º—ñ–Ω–Ω—ñ—Å—Ç—å —Ü—ñ—î—ó –≤–µ—Ä—Å—ñ—ó –≤—ñ–¥ —Ç—ñ—î—ó, —è–∫—É –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ —É [–ì–ª–∞–≤–∞ ?](game#domdisplay) –ø–æ–ª—è–≥–∞—î —É —Ç–æ–º—É, —â–æ –≤–æ–Ω–∞ –ø—Ä–∏–∑–Ω–∞—á–∞—î _–≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ_ –≤—É–∑–ª–∞–º DOM, –∞ –Ω–µ _–∞—Ç—Ä–∏–±—É—Ç–∏_. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–∏ –Ω–µ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ñ–≤, –∞–ª–µ –º–∏ _–º–æ–∂–µ–º–æ_ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π, –∑–Ω–∞—á–µ–Ω–Ω—è —è–∫–∏—Ö –Ω–µ —î —Ä—è–¥–∫–æ–º, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `onclick`, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —É —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –æ–±—Ä–æ–±–Ω–∏–∫–∞ –ø–æ–¥—ñ—ó –∫–ª—ñ–∫—É.

{{index ¬´button (HTML-—Ç–µ–≥)¬ª}}

–¶–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π –∑—Ä—É—á–Ω–∏–π —Å—Ç–∏–ª—å –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –ø–æ–¥—ñ–π:

```{lang: html}
<body
  <script>
    document.body.appendChild(elt(¬´button¬ª, {
      onclick: () => console.log(¬´click¬ª)
    }, ¬´–ö–Ω–æ–ø–∫–∞¬ª));
  </script> </span> </span> </span> </span> </span
</body> </body
```

## –ü–æ–ª–æ—Ç–Ω–æ

–ü–µ—Ä—à–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —è–∫–∏–π –º–∏ –≤–∏–∑–Ω–∞—á–∏–º–æ, - —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É, —è–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —É –≤–∏–≥–ª—è–¥—ñ —Å—ñ—Ç–∫–∏ –∫–æ–ª—å–æ—Ä–æ–≤–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫. –¶–µ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –¥–≤—ñ —Ä–µ—á—ñ: –ø–æ–∫–∞–∑—É—î –∫–∞—Ä—Ç–∏–Ω–∫—É —Ç–∞ –ø–µ—Ä–µ–¥–∞—î ((–ø–æ–¥—ñ—é –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞)) –Ω–∞ —Ü—é –∫–∞—Ä—Ç–∏–Ω–∫—É —Ä–µ—à—Ç—ñ –ø—Ä–æ–≥—Ä–∞–º–∏.

{{index ¬´PictureCanvas class¬ª, ¬´callback function¬ª, ¬´scale constant¬ª, ¬´canvas (HTML tag)¬ª, ¬´mousedown event¬ª, ¬´touchstart event¬ª, [state, ¬´of application¬ª]}}

–û—Ç–∂–µ, –º–∏ –º–æ–∂–µ–º–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –π–æ–≥–æ —è–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —è–∫–∏–π –∑–Ω–∞—î –ª–∏—à–µ –ø—Ä–æ –ø–æ—Ç–æ—á–Ω—É –∫–∞—Ä—Ç–∏–Ω–∫—É, –∞ –Ω–µ –ø—Ä–æ –≤–µ—Å—å —Å—Ç–∞–Ω –ø—Ä–æ–≥—Ä–∞–º–∏. –û—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –Ω–µ –∑–Ω–∞—î, —è–∫ –ø—Ä–∞—Ü—é—î –ø—Ä–æ–≥—Ä–∞–º–∞ –≤ —Ü—ñ–ª–æ–º—É, –≤—ñ–Ω –Ω–µ –º–æ–∂–µ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ ((–¥—ñ—é))–∏. –ù–∞—Ç–æ–º—ñ—Å—Ç—å, —Ä–µ–∞–≥—É—é—á–∏ –Ω–∞ –ø–æ–¥—ñ—ó –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞, –≤—ñ–Ω –≤–∏–∫–ª–∏–∫–∞—î —Ñ—É–Ω–∫—Ü—ñ—é –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É, –Ω–∞–¥–∞–Ω—É –∫–æ–¥–æ–º, —è–∫–∏–π –π–æ–≥–æ —Å—Ç–≤–æ—Ä–∏–≤, —è–∫–∞ –æ–±—Ä–æ–±–ª—è—î —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–∏ —á–∞—Å—Ç–∏–Ω–∏.

```{includeCode: true}
const scale = 10;

class PictureCanvas {
  constructor(picture, pointerDown) {
    this.dom = elt(¬´canvas¬ª, {
      onmousedown: event => this.mouse(event, pointerDown),
      ontouchstart: event => this.touch(event, pointerDown)
    });
    this.syncState(picture);
  }
  syncState(picture) {
    if (this.picture == picture) return;
    this.picture = picture;
    drawPicture(this.picture, this.dom, scale);
  }
}
```

{{index ¬´syncState method¬ª, efficiency}}

–ú–∏ –º–∞–ª—é—î–º–æ –∫–æ–∂–µ–Ω –ø—ñ–∫—Å–µ–ª—å —É –≤–∏–≥–ª—è–¥—ñ –∫–≤–∞–¥—Ä–∞—Ç—É 10 –Ω–∞ 10, —â–æ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ—é `scale`. –©–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –∑–∞–π–≤–æ—ó —Ä–æ–±–æ—Ç–∏, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ñ–¥—Å—Ç–µ–∂—É—î –ø–æ—Ç–æ—á–Ω—É –∫–∞—Ä—Ç–∏–Ω–∫—É —ñ –ø–µ—Ä–µ–º–∞–ª—å–æ–≤—É—î —ó—ó –ª–∏—à–µ —Ç–æ–¥—ñ, –∫–æ–ª–∏ `—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è` –æ—Ç—Ä–∏–º—É—î –Ω–æ–≤–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è.

{{index ¬´drawPicture function¬ª}}

–í–ª–∞—Å–Ω–µ —Ñ—É–Ω–∫—Ü—ñ—è –º–∞–ª—é–≤–∞–Ω–Ω—è –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î —Ä–æ–∑–º—ñ—Ä –ø–æ–ª–æ—Ç–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–∞—Å—à—Ç–∞–±—É —Ç–∞ —Ä–æ–∑–º—ñ—Ä—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ –∑–∞–ø–æ–≤–Ω—é—î –π–æ–≥–æ —Å–µ—Ä—ñ—î—é –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤, –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–æ–∂–µ–Ω –ø—ñ–∫—Å–µ–ª—å.

```{includeCode: true}
—Ñ—É–Ω–∫—Ü—ñ—è drawPicture(picture, canvas, scale) {
  canvas.width = picture.width * scale;
  canvas.height = picture.height * scale;
  let cx = canvas.getContext(¬´2d¬ª);

  for (let y = 0; y < picture.height; y++) {
    for (let x = 0; x < picture.width; x++) {
      cx.fillStyle = picture.pixel(x, y);
      cx.fillRect(x * scale, y * scale, scale, scale);
    }
  }
}
```

{{index ¬´mousedown event¬ª, ¬´mousemove event¬ª, ¬´button property¬ª, ¬´buttons property¬ª, ¬´pointerPosition function¬ª}}

–ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –ª—ñ–≤–æ—ó –∫–Ω–æ–ø–∫–∏ –º–∏—à—ñ, –∫–æ–ª–∏ –∫—É—Ä—Å–æ—Ä –º–∏—à—ñ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞–¥ –ø–æ–ª–æ—Ç–Ω–æ–º –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∏–∫–ª–∏–∫–∞—î —Ñ—É–Ω–∫—Ü—ñ—é –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É `pointerDown`, –ø–µ—Ä–µ–¥–∞—é—á–∏ —ó–π –ø–æ–∑–∏—Ü—ñ—é –ø—ñ–∫—Å–µ–ª—è, –Ω–∞ —è–∫–∏–π –±—É–ª–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç–æ, —É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è. –¶–µ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó –º–∏—à—ñ –∑ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º. –§—É–Ω–∫—Ü—ñ—è –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É –º–æ–∂–µ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ —ñ–Ω—à—É —Ñ—É–Ω–∫—Ü—ñ—é –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É, —è–∫–∞ –±—É–¥–µ —Å–ø–æ–≤—ñ—â–∞—Ç–∏ –ø—Ä–æ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞ –Ω–∞ —ñ–Ω—à–∏–π –ø—ñ–∫—Å–µ–ª—å –ø—Ä–∏ –Ω–∞—Ç–∏—Å–Ω—É—Ç—ñ–π –∫–Ω–æ–ø—Ü—ñ.

```{includeCode: true}
PictureCanvas.prototype.mouse = function(downEvent, onDown) {
  if (downEvent.button != 0) return;
  let pos = pointerPosition(downEvent, this.dom);
  let onMove = onDown(pos);
  if (!onMove) return;
  let move = moveEvent => {
    if (moveEvent.buttons == 0) {
      this.dom.removeEventListener(¬´mousemove¬ª, move);
    } else {
      –Ω–µ—Ö–∞–π newPos = pointerPosition(moveEvent, this.dom);
      if (newPos.x == pos.x && newPos.y == pos.y) return;
      pos = newPos;
      onMove(newPos);
    }
  };
  this.dom.addEventListener(¬´mousemove¬ª, move);
};

function pointerPosition(pos, domNode) {
  let rect = domNode.getBoundingClientRect();
  return {x: Math.floor((pos.clientX - rect.left) / scale),
          y: Math.floor((pos.clientY - rect.top) / scale)};
}
```

{{index ¬´–º–µ—Ç–æ–¥ getBoundingClientRect¬ª, ¬´–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å clientX¬ª, ¬´–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å clientY¬ª}}

–û—Å–∫—ñ–ª—å–∫–∏ –º–∏ –∑–Ω–∞—î–º–æ —Ä–æ–∑–º—ñ—Ä ((pixel))s —ñ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `getBoundingClientRect` –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –ø–æ–ª–æ–∂–µ–Ω–Ω—è –ø–æ–ª–æ—Ç–Ω–∞ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ, –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤—ñ–¥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ–¥—ñ–π –º–∏—à—ñ (`clientX` —ñ `clientY`) –¥–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è. –í–æ–Ω–∏ –∑–∞–≤–∂–¥–∏ –æ–∫—Ä—É–≥–ª—é—é—Ç—å—Å—è –≤–Ω–∏–∑, —â–æ–± –ø–æ—Å–∏–ª–∞—Ç–∏—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –ø—ñ–∫—Å–µ–ª—å.

{{index ¬´touchstart event¬ª, ¬´touchmove event¬ª, ¬´preventDefault method¬ª}}

–ó –ø–æ–¥—ñ—è–º–∏ –¥–æ—Ç–∏–∫—É –º–∏ –º–∞—î–º–æ –∑—Ä–æ–±–∏—Ç–∏ —â–æ—Å—å –ø–æ–¥—ñ–±–Ω–µ, –∞–ª–µ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —ñ–Ω—à–∏—Ö –ø–æ–¥—ñ–π —ñ –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º –≤–∏–∫–ª–∏–∫–æ–º `preventDefault` –Ω–∞ –ø–æ–¥—ñ—ó `¬´touchstart¬ª` –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è ((–ø–∞–Ω–æ—Ä–∞–º—É–≤–∞–Ω–Ω—è)).

```{includeCode: true}
PictureCanvas.prototype.touch = function(startEvent,
                                         onDown) {}}
  let pos = pointerPosition(startEvent.touches[0], this.dom);
  let onMove = onDown(pos);
  startEvent.preventDefault();
  if (!onMove) return;
  let move = moveEvent => {
    let newPos = pointerPosition(moveEvent.touches[0],
                                 this.dom);
    if (newPos.x == pos.x && newPos.y == pos.y) return;
    pos = newPos;
    onMove(newPos);
  };
  let end = () => {
    this.dom.removeEventListener(¬´touchmove¬ª, move);
    this.dom.removeEventListener(¬´touch¬ª, end);
  };
  this.dom.addEventListener(¬´touchmove¬ª, move);
  this.dom.addEventListener(¬´touchend¬ª, end);
};
```

{{index ¬´touches property¬ª, ¬´clientX property¬ª, ¬´clientY property¬ª}}

–î–ª—è –ø–æ–¥—ñ–π –¥–æ—Ç–∏–∫—É, `clientX` —Ç–∞ `clientY` –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ñ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –Ω–∞ –æ–±'—î–∫—Ç—ñ –ø–æ–¥—ñ—ó, –∞–ª–µ –º–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –ø–µ—Ä—à–æ–≥–æ –æ–±'—î–∫—Ç—É –¥–æ—Ç–∏–∫—É —É –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ `touches`.

## –î–æ–¥–∞—Ç–æ–∫

–î–ª—è —Ç–æ–≥–æ, —â–æ–± –º–æ–∂–Ω–∞ –±—É–ª–æ –∑–±–∏—Ä–∞—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫ –ø–æ —á–∞—Å—Ç–∏–Ω–∞—Ö, –º–∏ —Ä–µ–∞–ª—ñ–∑—É—î–º–æ –≥–æ–ª–æ–≤–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —è–∫ –æ–±–æ–ª–æ–Ω–∫—É –Ω–∞–≤–∫–æ–ª–æ –ø–æ–ª–æ—Ç–Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É ((tool))s —Ç–∞ ((control))s, —è–∫—ñ –º–∏ –ø–µ—Ä–µ–¥–∞—î–º–æ –π–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É.

–ï–ª–µ–º–µ–Ω—Ç–∏  —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è - —Ü–µ –µ–ª–µ–º–µ–Ω—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É, —è–∫—ñ –∑'—è–≤–ª—è—é—Ç—å—Å—è –ø—ñ–¥ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º. –í–æ–Ω–∏ –±—É–¥—É—Ç—å –Ω–∞–¥–∞–Ω—ñ —É –≤–∏–≥–ª—è–¥—ñ –º–∞—Å–∏–≤—É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ñ–≤ ((–∫–æ–º–ø–æ–Ω–µ–Ω—Ç)).

{{index ¬´br (HTML-—Ç–µ–≥)¬ª, ¬´flood fill¬ª, ¬´select (HTML-—Ç–µ–≥)¬ª, ¬´PixelEditor class¬ª, dispatch}}

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å —Ç–∞–∫—ñ –¥—ñ—ó, —è–∫ –º–∞–ª—é–≤–∞–Ω–Ω—è –ø—ñ–∫—Å–µ–ª—ñ–≤ –∞–±–æ –∑–∞–ª–∏–≤–∫–∞ –æ–±–ª–∞—Å—Ç—ñ. –ü—Ä–æ–≥—Ä–∞–º–∞ –ø–æ–∫–∞–∑—É—î –Ω–∞–±—ñ—Ä –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —É –≤–∏–≥–ª—è–¥—ñ –ø–æ–ª—è `<select>`. –ü–æ—Ç–æ—á–Ω–æ –≤–∏–±—Ä–∞–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–∏–∑–Ω–∞—á–∞—î, —â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∑–∞—î–º–æ–¥—ñ—î –∑ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∫–∞–∑—ñ–≤–Ω–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é. –ù–∞–±—ñ—Ä –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –Ω–∞–¥–∞—î—Ç—å—Å—è —É –≤–∏–≥–ª—è–¥—ñ –æ–±'—î–∫—Ç–∞, —è–∫–∏–π –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –Ω–∞–∑–≤–∏, —â–æ –∑'—è–≤–ª—è—é—Ç—å—Å—è —É –≤–∏–ø–∞–¥–∞—é—á–æ–º—É –ø–æ–ª—ñ, –Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å —Ü—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏. –¢–∞–∫—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –æ—Ç—Ä–∏–º—É—é—Ç—å –ø–æ–∑–∏—Ü—ñ—é –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω –ø—Ä–æ–≥—Ä–∞–º–∏ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—é `dispatch` —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–∏. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é-–æ–±—Ä–æ–±–Ω–∏–∫ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è, —è–∫–∞ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∑ –Ω–æ–≤–æ—é –ø–æ–∑–∏—Ü—ñ—î—é —ñ –ø–æ—Ç–æ—á–Ω–∏–º —Å—Ç–∞–Ω–æ–º, –∫–æ–ª–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –ø–µ—Ä–µ–º—ñ—â—É—î—Ç—å—Å—è –Ω–∞ —ñ–Ω—à–∏–π –ø—ñ–∫—Å–µ–ª—å.

```{includeCode: true}
class PixelEditor {
  constructor(state, config) {
    let {tools, controls, dispatch} = config;
    this.state = state;

    this.canvas = new PictureCanvas(state.picture, pos => {
      let tool = tools[this.state.tool];
      let onMove = tool(pos, this.state, dispatch);
      if (onMove) return pos => onMove(pos, this.state);
    });
    this.controls = controls.map(
      Control => new Control(state, config));
    this.dom = elt(¬´div¬ª, {}, this.canvas.dom, elt(¬´br¬ª),
                   ...this.controls.reduce(
                     (a, c) => a.concat(¬ª ¬ª, c.dom), []));
  }
  syncState(state) {
    this.state = state;
    this.canvas.syncState(state.picture);
    for (let ctrl of this.controls) ctrl.syncState(state);
  }
}
```

–û–±—Ä–æ–±–Ω–∏–∫ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞, –ø–µ—Ä–µ–¥–∞–Ω–∏–π `PictureCanvas`, –≤–∏–∫–ª–∏–∫–∞—î –ø–æ—Ç–æ—á–Ω–∏–π –≤–∏–±—Ä–∞–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ —ñ, —è–∫—â–æ —Ç–æ–π –ø–æ–≤–µ—Ä—Ç–∞—î –æ–±—Ä–æ–±–Ω–∏–∫ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è, –∞–¥–∞–ø—Ç—É—î –π–æ–≥–æ, —â–æ–± —Ç–∞–∫–æ–∂ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å—Ç–∞–Ω.

{{index ¬´reduce method¬ª, ¬´map method¬ª, [–ø—Ä–æ–±—ñ–ª–∏, ¬´in HTML¬ª], ¬´syncState method¬ª}}

–í—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É `this.controls`, —â–æ–± —ó—Ö –º–æ–∂–Ω–∞ –±—É–ª–æ –æ–Ω–æ–≤–∏—Ç–∏ –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Å—Ç–∞–Ω—É –ø—Ä–æ–≥—Ä–∞–º–∏. –í–∏–∫–ª–∏–∫ `reduce` –≤–≤–æ–¥–∏—Ç—å –ø—Ä–æ–±—ñ–ª–∏ –º—ñ–∂ DOM-–µ–ª–µ–º–µ–Ω—Ç–∞–º–∏ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–æ–Ω–∏ –Ω–µ –≤–∏–≥–ª—è–¥–∞—é—Ç—å –ø—Ä–∏—Ç–∏—Å–Ω—É—Ç–∏–º–∏ –æ–¥–∏–Ω –¥–æ –æ–¥–Ω–æ–≥–æ.

{{index ¬´select (HTML-—Ç–µ–≥)¬ª, ¬´change event¬ª, ¬´ToolSelect class¬ª, ¬´syncState method¬ª}}

–ü–µ—Ä—à–∏–π –µ–ª–µ–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è - —Ü–µ –º–µ–Ω—é –≤–∏–±–æ—Ä—É ((tool)). –í—ñ–Ω —Å—Ç–≤–æ—Ä—é—î –µ–ª–µ–º–µ–Ω—Ç `<select>` –∑ –æ–ø—Ü—ñ—î—é –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ —ñ –Ω–∞–ª–∞—à—Ç–æ–≤—É—î –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ—ó `¬´change¬ª`, —è–∫–∏–π –æ–Ω–æ–≤–ª—é—î —Å—Ç–∞–Ω –ø—Ä–æ–≥—Ä–∞–º–∏, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±–∏—Ä–∞—î —ñ–Ω—à–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç.

```{includeCode: true}
class ToolSelect {
  constructor(state, {tools, dispatch}) {
    this.select = elt(¬´select¬ª, {
      onchange: () => dispatch({tool: this.select.value})
    }, ...Object.keys(tools).map(name => elt(¬´option¬ª, {
      selected: name == state.tool
    }, name)));
    this.dom = elt(¬´label¬ª, null, ¬´üñå Tool: ¬ª, this.select);
  }
  syncState(state) { this.select.value = state.tool; }
}
```

{{index ¬´label (HTML-—Ç–µ–≥)¬ª}}

–û–±–µ—Ä—Ç–∞—é—á–∏ —Ç–µ–∫—Å—Ç –º—ñ—Ç–∫–∏ —ñ –ø–æ–ª–µ –≤ –µ–ª–µ–º–µ–Ω—Ç `<label>`, –º–∏ –ø–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –±—Ä–∞—É–∑–µ—Ä—É, —â–æ –º—ñ—Ç–∫–∞ –Ω–∞–ª–µ–∂–∏—Ç—å –¥–æ —Ü—å–æ–≥–æ –ø–æ–ª—è, —Ç–∞–∫ —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–ª–∞—Ü–Ω—É—Ç–∏ –Ω–∞ –º—ñ—Ç—Ü—ñ, —â–æ–± —Å—Ñ–æ–∫—É—Å—É–≤–∞—Ç–∏ –ø–æ–ª–µ.

{{index ¬´color field¬ª, ¬´input (HTML tag)¬ª}}

–ù–∞–º —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∫–æ–ª—ñ—Ä, —Ç–æ–º—É –¥–æ–¥–∞–º–æ –µ–ª–µ–º–µ–Ω—Ç –∫–µ—Ä—É–≤–∞–Ω–Ω—è –¥–ª—è —Ü—å–æ–≥–æ. HTML-–µ–ª–µ–º–µ–Ω—Ç `<input>` –∑ –∞—Ç—Ä–∏–±—É—Ç–æ–º `type`, —â–æ –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è `color`, –Ω–∞–¥–∞—î –Ω–∞–º –ø–æ–ª–µ —Ñ–æ—Ä–º–∏, —è–∫–µ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –¥–ª—è –≤–∏–±–æ—Ä—É –∫–æ–ª—å–æ—Ä—É. –ó–Ω–∞—á–µ–Ω–Ω—è–º —Ç–∞–∫–æ–≥–æ –ø–æ–ª—è –∑–∞–≤–∂–¥–∏ —î –∫–æ–¥ –∫–æ–ª—å–æ—Ä—É CSS —É —Ñ–æ—Ä–º–∞—Ç—ñ `¬´#RRGGBB¬ª` (—á–µ—Ä–≤–æ–Ω–∏–π, –∑–µ–ª–µ–Ω–∏–π —ñ —Å–∏–Ω—ñ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, –ø–æ –¥–≤—ñ —Ü–∏—Ñ—Ä–∏ –Ω–∞ –∫–æ–ª—ñ—Ä). –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∂–µ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å ((–ø—ñ–ø–µ—Ç–∫–∞ –∫–æ–ª—å–æ—Ä—ñ–≤)), –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±—É–¥–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –Ω–∏–º.

{{if book

–ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –±—Ä–∞—É–∑–µ—Ä–∞, –ø—ñ–ø–µ—Ç–∫–∞ –∫–æ–ª—å–æ—Ä—ñ–≤ –º–æ–∂–µ –º–∞—Ç–∏ —Ç–∞–∫–∏–π –≤–∏–≥–ª—è–¥:

{{figure {url: ¬´img/color-field.png¬ª, alt: ¬´–ó–Ω—ñ–º–æ–∫ –ø–æ–ª—è –∫–æ–ª—å–æ—Ä—É¬ª, width: ‚Äú6cm‚Äù}}}}

if}}

{{index ¬´ColorSelect class¬ª, ¬´syncState method¬ª}}

–¶–µ–π ((–µ–ª–µ–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è)) —Å—Ç–≤–æ—Ä—é—î —Ç–∞–∫–µ –ø–æ–ª–µ —ñ –ø—ñ–¥–∫–ª—é—á–∞—î –π–æ–≥–æ –¥–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∑ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—é `color` —Å—Ç–∞–Ω—É –ø—Ä–æ–≥—Ä–∞–º–∏.

```{includeCode: true}
class ColorSelect {
  constructor(state, {dispatch}) {
    this.input = elt(¬´input¬ª, {
      —Ç–∏–ø: ¬´color¬ª,
      value: state.color,
      onchange: () => dispatch({color: this.input.value})
    });
    this.dom = elt(¬´label¬ª, null, ¬´üé® –ö–æ–ª—ñ—Ä: ¬ª, this.input);
  }
  syncState(state) { this.input.value = state.color; }
}
```

## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –º–∞–ª—é–≤–∞–Ω–Ω—è

–ü–µ—Ä—à –Ω—ñ–∂ –º–∏ –∑–º–æ–∂–µ–º–æ —â–æ—Å—å –Ω–∞–º–∞–ª—é–≤–∞—Ç–∏, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ ((—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç))–∏, —è–∫—ñ –±—É–¥—É—Ç—å –∫–µ—Ä—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—é –ø–æ–¥—ñ–π –º–∏—à—ñ –∞–±–æ –¥–æ—Ç–∏–∫—É –Ω–∞ –ø–æ–ª–æ—Ç–Ω—ñ.

{{index ¬´draw function¬ª}}

–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º —î —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–∞–ª—é–≤–∞–Ω–Ω—è, —è–∫–∏–π –∑–º—ñ–Ω—é—î –±—É–¥—å-—è–∫–∏–π ((–ø—ñ–∫—Å–µ–ª—å)), –Ω–∞ —è–∫–∏–π –≤–∏ –Ω–∞—Ç–∏—Å–∫–∞—î—Ç–µ –∞–±–æ —Ç–æ—Ä–∫–∞—î—Ç–µ—Å—å, –Ω–∞ –ø–æ—Ç–æ—á–Ω–∏–π –≤–∏–±—Ä–∞–Ω–∏–π –∫–æ–ª—ñ—Ä. –í—ñ–Ω –≤–∏–∫–æ–Ω—É—î –¥—ñ—é, —è–∫–∞ –æ–Ω–æ–≤–ª—é—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ –≤–µ—Ä—Å—ñ—ó, —É —è–∫—ñ–π –ø—ñ–∫—Å–µ–ª—å, –Ω–∞ —è–∫–∏–π –≤–∫–∞–∑–∞–Ω–æ, –Ω–∞–±—É–≤–∞—î –ø–æ—Ç–æ—á–Ω–æ–≥–æ –≤–∏–±—Ä–∞–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É.

```{includeCode: true}
function draw(pos, state, dispatch) {
  function drawPixel({x, y}, state) {
    let drawn = {x, y, color: state.color};
    dispatch({picture: state.picture.draw([drawn])});
  }
  drawPixel(pos, state);
  return drawPixel;
}
```

–§—É–Ω–∫—Ü—ñ—è –Ω–µ–≥–∞–π–Ω–æ –≤–∏–∫–ª–∏–∫–∞—î —Ñ—É–Ω–∫—Ü—ñ—é `drawPixel`, –∞–ª–µ –ø–æ—Ç—ñ–º —Ç–∞–∫–æ–∂ –ø–æ–≤–µ—Ä—Ç–∞—î —ó—ó, —â–æ–± –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —ó—ó –∑–Ω–æ–≤—É –¥–ª—è –Ω–æ–≤–∏—Ö –ø—ñ–∫—Å–µ–ª—ñ–≤, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ—Ç—è–≥—É—î –∞–±–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å ((—Å–≤–∞–π–ø–æ–º)) –ø–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—é.

{{index ¬´rectangle function¬ª}}

–î–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è –±—ñ–ª—å—à–∏—Ö —Ñ—ñ–≥—É—Ä –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º —à–≤–∏–¥–∫–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è ((–ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫–∞))s. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `–ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫` ((—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)) –º–∞–ª—é—î –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ –º—ñ–∂ —Ç–æ—á–∫–æ—é, –∑ —è–∫–æ—ó –≤–∏ –ø–æ—á–∏–Ω–∞—î—Ç–µ ((–ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è)), —ñ —Ç–æ—á–∫–æ—é, –¥–æ —è–∫–æ—ó –≤–∏ –ø–µ—Ä–µ—Ç—è–≥—É—î—Ç–µ.

```{includeCode: true}
function rectangle(start, state, dispatch) {
  function drawRectangle(pos) {
    let xStart = Math.min(start.x, pos.x)
    let yStart = Math.min(start.y, pos.y)
    let xEnd = Math.max(start.x, pos.x)
    let yEnd = Math.max(start.y, pos.y);
    let drawn = [];
    for (let y = yStart; y <= yEnd; y++) {
      for (let x = xStart; x <= xEnd; x++) {
        drawn.push({x, y, color: state.color});
      }
    }
    dispatch({picture: state.picture.draw(drawn)});
  }
  drawRectangle(start);
  return drawRectangle;
}
```

{{index ¬´persistent data structure¬ª, [state, persistence]}}

–í–∞–∂–ª–∏–≤–æ—é –¥–µ—Ç–∞–ª–ª—é —É —Ü—ñ–π —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —î —Ç–µ, —â–æ –ø—Ä–∏ –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—ñ –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ –ø–µ—Ä–µ–º–∞–ª—å–æ–≤—É—î—Ç—å—Å—è –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ –∑ _–ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ_ —Å—Ç–∞–Ω—É. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–±–∏—Ç–∏ –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ –±—ñ–ª—å—à–∏–º —ñ –º–µ–Ω—à–∏–º –∑–Ω–æ–≤—É –ø—ñ–¥ —á–∞—Å –π–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, –±–µ–∑ –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫—ñ–≤, —â–æ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –Ω–∞ –∫—ñ–Ω—Ü–µ–≤–æ–º—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ. –¶–µ –æ–¥–Ω–∞ –∑ –ø—Ä–∏—á–∏–Ω, —á–æ–º—É ((–Ω–µ–∑–º—ñ–Ω–Ω—ñ)) –æ–±'—î–∫—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å —î –∫–æ—Ä–∏—Å–Ω–∏–º–∏ - –º–∏ –ø–æ–±–∞—á–∏–º–æ —ñ–Ω—à—É –ø—Ä–∏—á–∏–Ω—É –ø—ñ–∑–Ω—ñ—à–µ.

–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è ((–∑–∞–ª–∏–≤–∫–∞)) –¥–µ—â–æ —Å–∫–ª–∞–¥–Ω—ñ—à–∞. –¶–µ ((—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)), —è–∫–∏–π –∑–∞–ª–∏–≤–∞—î –ø—ñ–∫—Å–µ–ª—å –ø—ñ–¥ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–æ–º —ñ –≤—Å—ñ —Å—É—Å—ñ–¥–Ω—ñ –ø—ñ–∫—Å–µ–ª—ñ, —è–∫—ñ –º–∞—é—Ç—å —Ç–∞–∫–∏–π —Å–∞–º–∏–π –∫–æ–ª—ñ—Ä. ¬´–°—É–º—ñ–∂–Ω—ñ¬ª –æ–∑–Ω–∞—á–∞—î –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ —Å—É—Å—ñ–¥–Ω—ñ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—ñ –∞–±–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—ñ, –∞ –Ω–µ –ø–æ –¥—ñ–∞–≥–æ–Ω–∞–ª—ñ. –¶–µ–π –º–∞–ª—é–Ω–æ–∫ —ñ–ª—é—Å—Ç—Ä—É—î –Ω–∞–±—ñ—Ä ((–ø—ñ–∫—Å–µ–ª—ñ–≤)), —è–∫—ñ –∑–∞—Ñ–∞—Ä–±–æ–≤—É—é—Ç—å—Å—è –ø—Ä–∏ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∑–∞–ª–∏–≤–∫–∏ –¥–æ –ø–æ–∑–Ω–∞—á–µ–Ω–æ–≥–æ –ø—ñ–∫—Å–µ–ª—è:

{{figure {url: ¬´img/flood-grid.svg¬ª, alt: ¬´–î—ñ–∞–≥—Ä–∞–º–∞ –ø—ñ–∫—Å–µ–ª—å–Ω–æ—ó —Å—ñ—Ç–∫–∏, —â–æ –ø–æ–∫–∞–∑—É—î –æ–±–ª–∞—Å—Ç—å, –∑–∞–ø–æ–≤–Ω–µ–Ω—É –æ–ø–µ—Ä–∞—Ü—ñ—î—é –∑–∞–ª–∏–≤–∫–∏¬ª, width: ‚Äú6cm‚Äù}}}}

{{index ¬´fill function¬ª}}

–¶—ñ–∫–∞–≤–æ, —â–æ —Å–ø–æ—Å—ñ–±, —É —è–∫–∏–π –º–∏ —Ü–µ –∑—Ä–æ–±–∏–º–æ, —Ç—Ä–æ—Ö–∏ —Å—Ö–æ–∂–∏–π –Ω–∞ –∫–æ–¥ ((–ø–æ—à—É–∫ —à–ª—è—Ö—É)) –∑ [–†–æ–∑–¥—ñ–ª ?](—Ä–æ–±–æ—Ç). –£ —Ç–æ–π —á–∞—Å —è–∫ —Ç–æ–π –∫–æ–¥ —à—É–∫–∞–≤ –º–∞—Ä—à—Ä—É—Ç –Ω–∞ –≥—Ä–∞—Ñ—ñ, —Ü–µ–π –∫–æ–¥ —à—É–∫–∞—î –ø–æ —Å—ñ—Ç—Ü—ñ, —â–æ–± –∑–Ω–∞–π—Ç–∏ –≤—Å—ñ ¬´–∑'—î–¥–Ω–∞–Ω—ñ¬ª –ø—ñ–∫—Å–µ–ª—ñ. –ü—Ä–æ–±–ª–µ–º–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–≥–∞–ª—É–∂–µ–Ω–æ—ó –º–Ω–æ–∂–∏–Ω–∏ –º–æ–∂–ª–∏–≤–∏—Ö –º–∞—Ä—à—Ä—É—Ç—ñ–≤ —Å—Ö–æ–∂–∞.

```{includeCode: true}
const around = [{dx: -1, dy: 0}, {dx: 1, dy: 0},
                {dx: 0, dy: -1}, {dx: 0, dy: 1}];

function fill({x, y}, state, dispatch) {
  let targetColor = state.picture.pixel(x, y);
  let drawn = [{x, y, color: state.color}];
  let visited = new Set();
  for (let done = 0; done < drawn.length; done++) {
    for (let {dx, dy} of around) {
      let x = drawn[done].x + dx, y = drawn[done].y + dy;
      if (x >= 0 && x < state.picture.width &&
          y >= 0 && y < state.picture.height &&)
          !visited.has(x + ¬´,¬ª + y) && !visited.has(x + ¬´,¬ª + y) &&
          state.picture.pixel(x, y) == targetColor) { })
        drawn.push({x, y, color: state.color});
        visited.add(x + ¬´,¬ª + y);
      }
    }
  }
  dispatch({picture: state.picture.draw(drawn)});
}
```

–ú–∞—Å–∏–≤ –Ω–∞–º–∞–ª—å–æ–≤–∞–Ω–∏—Ö –ø—ñ–∫—Å–µ–ª—ñ–≤ –ø–æ–¥–≤–æ—é—î—Ç—å—Å—è —É —Ñ—É–Ω–∫—Ü—ñ—ó ((—Ä–æ–±–æ—á–∏–π —Å–ø–∏—Å–æ–∫)). –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –¥–æ—Å—è–≥–Ω—É—Ç–æ–≥–æ –ø—ñ–∫—Å–µ–ª—è –º–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —Å—É—Å—ñ–¥–Ω—ñ –ø—ñ–∫—Å–µ–ª—ñ –º–∞—é—Ç—å —Ç–∞–∫–∏–π —Å–∞–º–∏–π –∫–æ–ª—ñ—Ä —ñ –Ω–µ –±—É–ª–∏ –∑–∞—Ñ–∞—Ä–±–æ–≤–∞–Ω—ñ. –õ—ñ—á–∏–ª—å–Ω–∏–∫ —Ü–∏–∫–ª—É –≤—ñ–¥—Å—Ç–∞—î –≤—ñ–¥ –¥–æ–≤–∂–∏–Ω–∏ –º–∞—Å–∏–≤—É ¬´–Ω–∞–º–∞–ª—å–æ–≤–∞–Ω–∏—Ö¬ª –ø—ñ–∫—Å–µ–ª—ñ–≤, –∫–æ–ª–∏ –¥–æ–¥–∞—é—Ç—å—Å—è –Ω–æ–≤—ñ –ø—ñ–∫—Å–µ–ª—ñ. –ë—É–¥—å-—è–∫—ñ –ø—ñ–∫—Å–µ–ª—ñ –ø–µ—Ä–µ–¥ –Ω–∏–º —â–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ—Å–ª—ñ–¥–∏—Ç–∏. –ö–æ–ª–∏ –≤—ñ–Ω –Ω–∞–∑–¥–æ–≥–∞–Ω—è—î –¥–æ–≤–∂–∏–Ω—É –º–∞—Å–∏–≤—É, –Ω–µ –∑–∞–ª–∏—à–∏—Ç—å—Å—è –∂–æ–¥–Ω–æ–≥–æ –Ω–µ–¥–æ—Å–ª—ñ–¥–∂–µ–Ω–æ–≥–æ –ø—ñ–∫—Å–µ–ª—è, —ñ —Ñ—É–Ω–∫—Ü—ñ—è –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è.

{{index ¬´pick function¬ª}}

–û—Å—Ç–∞–Ω–Ω—ñ–º ((—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º)) —î ((–ø—ñ–ø–µ—Ç–∫–∞)), —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∫–∞–∑–∞—Ç–∏ –Ω–∞ –∫–æ–ª—ñ—Ä –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ, —â–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –π–æ–≥–æ —è–∫ –ø–æ—Ç–æ—á–Ω–∏–π –∫–æ–ª—ñ—Ä –º–∞–ª—é–≤–∞–Ω–Ω—è.

```{includeCode: true}
function pick(pos, state, dispatch) {
  dispatch({color: state.picture.pixel(pos.x, pos.y)});
}
```

{{if —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π

–¢–µ–ø–µ—Ä –º–∏ –º–æ–∂–µ–º–æ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –Ω–∞—à –¥–æ–¥–∞—Ç–æ–∫!

```{lang: html}
<div></div>
<script>
  let state = {
    —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: ¬´draw¬ª,
    color: ¬´#000000¬ª,
    –º–∞–ª—é–Ω–æ–∫: Picture.empty(60, 30, ¬´#f0f0f0¬ª)
  };
  let app = new PixelEditor(state, {
    tools: {draw, fill, rectangle, pick},
    controls: [ToolSelect, ColorSelect],
    dispatch(action) {
      state = updateState(state, action);
      app.syncState(state);
    }
  });
  document.querySelector(¬´div¬ª).appendChild(app.dom);
</script>
```

if}}

## –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

{{index ¬´SaveButton class¬ª, ¬´drawPicture function¬ª, [file, image]}}

–ö–æ–ª–∏ –º–∏ –Ω–∞–º–∞–ª—é—î–º–æ –Ω–∞—à —à–µ–¥–µ–≤—Ä, –º–∏ –∑–∞—Ö–æ—á–µ–º–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –π–æ–≥–æ –Ω–∞ –ø–æ—Ç—ñ–º. –ù–∞–º —Å–ª—ñ–¥ –¥–æ–¥–∞—Ç–∏ –∫–Ω–æ–ø–∫—É –¥–ª—è ((–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è)) –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –º–∞–ª—é–Ω–∫–∞ —É –≤–∏–≥–ª—è–¥—ñ –≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ —Ñ–∞–π–ª—É. –¶–µ–π ((–µ–ª–µ–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è)) –Ω–∞–¥–∞—î —Ç–∞–∫—É –∫–Ω–æ–ø–∫—É:

```{includeCode: true}
class SaveButton {
  constructor(state) {
    this.picture = state.picture;
    this.dom = elt(¬´button¬ª, {
      onclick: () => this.save()
    }, ¬´üíæ –ó–±–µ—Ä–µ–≥—Ç–∏¬ª);
  }
  save() {
    let canvas = elt(¬´canvas¬ª);
    drawPicture(this.picture, canvas, 1);
    let link = elt(¬´a¬ª, {
      href: canvas.toDataURL(),
      download: ¬´pixelart.png¬ª
    });
    document.body.appendChild(link);
    link.click();
    link.remove();
  }
  syncState(state) { this.picture = state.picture; }
}
```

{{index ¬´canvas (HTML-—Ç–µ–≥)¬ª}}

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ñ–¥—Å—Ç–µ–∂—É—î –ø–æ—Ç–æ—á–Ω—É –∫–∞—Ä—Ç–∏–Ω–∫—É, —â–æ–± –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –Ω–µ—ó –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ. –î–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –µ–ª–µ–º–µ–Ω—Ç `<canvas>`, –Ω–∞ —è–∫–æ–º—É –º–∞–ª—é—î –∫–∞—Ä—Ç–∏–Ω–∫—É (—É –º–∞—Å—à—Ç–∞–±—ñ –æ–¥–∏–Ω –ø—ñ–∫—Å–µ–ª—å –Ω–∞ –ø—ñ–∫—Å–µ–ª—å).

{{index ¬´toDataURL –º–µ—Ç–æ–¥¬ª, ¬´URL –¥–∞–Ω–∏—Ö¬ª}}

–ú–µ—Ç–æ–¥ `toDataURL` –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç—ñ –ø–æ–ª–æ—Ç–Ω–∞ —Å—Ç–≤–æ—Ä—é—î URL-–∞–¥—Ä–µ—Å—É, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ö–µ–º—É `data:`. –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ URL-–∞–¥—Ä–µ—Å `http:` —ñ `https:`, URL-–∞–¥—Ä–µ—Å–∏ –¥–∞–Ω–∏—Ö –º—ñ—Å—Ç—è—Ç—å –≤–µ—Å—å —Ä–µ—Å—É—Ä—Å –≤ URL-–∞–¥—Ä–µ—Å—ñ. –ó–∞–∑–≤–∏—á–∞–π –≤–æ–Ω–∏ –¥—É–∂–µ –¥–æ–≤–≥—ñ, –∞–ª–µ –¥–æ–∑–≤–æ–ª—è—é—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ä–æ–±–æ—á—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –¥–æ–≤—ñ–ª—å–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—Ä—è–º–æ —Ç—É—Ç, —É –±—Ä–∞—É–∑–µ—Ä—ñ.

{{index ¬´a (HTML-—Ç–µ–≥)¬ª, ¬´download attribute¬ª}}

–©–æ–± –∑–º—É—Å–∏—Ç–∏ –±—Ä–∞—É–∑–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –º–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –µ–ª–µ–º–µ–Ω—Ç ((–ø–æ—Å–∏–ª–∞–Ω–Ω—è)), —è–∫–∏–π –≤–∫–∞–∑—É—î –Ω–∞ —Ü—é URL-–∞–¥—Ä–µ—Å—É —ñ –º–∞—î –∞—Ç—Ä–∏–±—É—Ç `download`. –¢–∞–∫—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è, –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –Ω–∞ –Ω–∏—Ö, –∑–º—É—à—É—é—Ç—å –±—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑–∞—Ç–∏ –¥—ñ–∞–ª–æ–≥–æ–≤–µ –≤—ñ–∫–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É. –ú–∏ –¥–æ–¥–∞—î–º–æ —Ü–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç, —ñ–º—ñ—Ç—É—î–º–æ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –Ω–∞ –Ω—å–æ–≥–æ —ñ –∑–Ω–æ–≤—É –≤–∏–¥–∞–ª—è—î–º–æ –π–æ–≥–æ. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó ((–±—Ä–∞—É–∑–µ—Ä)) –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –±–∞–≥–∞—Ç–æ —á–æ–≥–æ, –∞–ª–µ —ñ–Ω–æ–¥—ñ —Ü–µ —Ä–æ–±–∏—Ç—å—Å—è –¥–æ—Å–∏—Ç—å –¥–∏–≤–Ω–∏–º —á–∏–Ω–æ–º.

{{index ¬´LoadButton class¬ª, control, [file, image]}}

–Ü —Ü–µ —â–µ –Ω–µ –≤—Å–µ. –ú–∏ —Ç–∞–∫–æ–∂ —Ö–æ—á–µ–º–æ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —ñ—Å–Ω—É—é—á—ñ —Ñ–∞–π–ª–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å —É –Ω–∞—à –¥–æ–¥–∞—Ç–æ–∫. –î–ª—è —Ü—å–æ–≥–æ –º–∏ –∑–Ω–æ–≤—É –≤–∏–∑–Ω–∞—á–∏–º–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–Ω–æ–ø–∫–∏.

```{includeCode: true}
class LoadButton {
  constructor(_, {dispatch}) {
    this.dom = elt(¬´button¬ª, {
      onclick: () => startLoad(dispatch)
    }, ¬´üìÅ Load¬ª);
  }
  syncState() {}
}

function startLoad(dispatch) {
  let input = elt(¬´input¬ª, {
    —Ç–∏–ø: ¬´file¬ª,
    onchange: () => finishLoad(input.files[0], dispatch)
  });
  document.body.appendChild(input);
  input.click();
  input.remove();
}
```

{{index [—Ñ–∞–π–ª, –¥–æ—Å—Ç—É–ø], ¬´input (HTML-—Ç–µ–≥)¬ª}}

–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—É –Ω–∞ –∫–æ–º–ø'—é—Ç–µ—Ä—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±—Ä–∞–≤ —Ñ–∞–π–ª —á–µ—Ä–µ–∑ –ø–æ–ª–µ –≤–≤–µ–¥–µ–Ω–Ω—è —Ñ–∞–π–ª—É. –ê–ª–µ –º–∏ –Ω–µ —Ö–æ—á–µ–º–æ, —â–æ–± –∫–Ω–æ–ø–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–∏–≥–ª—è–¥–∞–ª–∞ —è–∫ –ø–æ–ª–µ –≤–≤–µ–¥–µ–Ω–Ω—è —Ñ–∞–π–ª—É, —Ç–æ–º—É –º–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –≤–≤–µ–¥–µ–Ω–Ω—è —Ñ–∞–π–ª—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –∫–Ω–æ–ø–∫–∏, –∞ –ø–æ—Ç—ñ–º –≤–¥–∞—î–º–æ, —â–æ —Ü–µ —Å–∞–º–µ –≤–≤–µ–¥–µ–Ω–Ω—è —Ñ–∞–π–ª—É –±—É–ª–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç–æ.

{{index ¬´FileReader class¬ª, ¬´img (HTML-—Ç–µ–≥)¬ª, ¬´readAsDataURL method¬ª, ¬´Picture class¬ª}}

–ö–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±—Ä–∞–≤ —Ñ–∞–π–ª, –º–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `FileReader`, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –π–æ–≥–æ –≤–º—ñ—Å—Ç—É, –∑–Ω–æ–≤—É –∂ —Ç–∞–∫–∏ —è–∫ ((URL-–∞–¥—Ä–µ—Å—É –¥–∞–Ω–∏—Ö)). –¶—è URL-–∞–¥—Ä–µ—Å–∞ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç–∞ `<img>`, –∞–ª–µ –æ—Å–∫—ñ–ª—å–∫–∏ –º–∏ –Ω–µ –º–æ–∂–µ–º–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –ø—ñ–∫—Å–µ–ª—ñ–≤ —Ç–∞–∫–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –º–∏ –Ω–µ –º–æ–∂–µ–º–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑ –Ω—å–æ–≥–æ –æ–±'—î–∫—Ç `Picture`.

```{includeCode: true}
function finishLoad(file, dispatch) {
  if (file == null) return;
  let reader = new FileReader();
  reader.addEventListener(¬´load¬ª, () => {
    let image = elt(¬´img¬ª, {
      onload: () => dispatch({
        picture: pictureFromImage(image)
      }),
      src: reader.result
    });
  });
  reader.readAsDataURL(file);
}
```

{{index ¬´canvas (HTML-—Ç–µ–≥)¬ª, ¬´getImageData –º–µ—Ç–æ–¥¬ª, ¬´pictureFromImage —Ñ—É–Ω–∫—Ü—ñ—è¬ª}}

–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –ø—ñ–∫—Å–µ–ª—ñ–≤, –º–∏ –ø–æ–≤–∏–Ω–Ω—ñ —Å–ø–æ—á–∞—Ç–∫—É –Ω–∞–º–∞–ª—é–≤–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ `<canvas>`. –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª–æ—Ç–Ω–∞ –º–∞—î –º–µ—Ç–æ–¥ `getImageData`, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î —Å–∫—Ä–∏–ø—Ç—É –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –π–æ–≥–æ ((pixel))s. –û—Ç–∂–µ, –∫–æ–ª–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –±—É–¥–µ –Ω–∞ –ø–æ–ª–æ—Ç–Ω—ñ, –º–∏ –∑–º–æ–∂–µ–º–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ –Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±'—î–∫—Ç `Picture`.

```{includeCode: true}
function pictureFromImage(image) {
  let width = Math.min(100, image.width)
  let height = Math.min(100, image.height);
  let canvas = elt(¬´canvas¬ª, {width, height});
  let cx = canvas.getContext(¬´2d¬ª);
  cx.drawImage(image, 0, 0);
  let pixels = [];
  let {data} = cx.getImageData(0, 0, width, height);

  function hex(n) {
    return n.toString(16).padStart(2, ¬´0¬ª);
  }
  for (let i = 0; i < data.length; i += 4) {
    let [r, g, b] = data.slice(i, i + 3);
    pixels.push(¬´#¬ª + hex(r) + hex(g) + hex(b));
  }
  return new Picture(width, height, pixels);
}
```

–ú–∏ –æ–±–º–µ–∂–∏–º–æ —Ä–æ–∑–º—ñ—Ä –∑–æ–±—Ä–∞–∂–µ–Ω—å –¥–æ 100 –Ω–∞ 100 –ø—ñ–∫—Å–µ–ª—ñ–≤, –æ—Å–∫—ñ–ª—å–∫–∏ –±—ñ–ª—å—à—ñ –±—É–¥—É—Ç—å –≤–∏–≥–ª—è–¥–∞—Ç–∏ _–≤–µ–ª–∏—á–µ–∑–Ω–∏–º–∏_ –Ω–∞ –Ω–∞—à–æ–º—É –¥–∏—Å–ø–ª–µ—ó —ñ –º–æ–∂—É—Ç—å —Å–ø–æ–≤—ñ–ª—å–Ω–∏—Ç–∏ —Ä–æ–±–æ—Ç—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.

{{index ¬´–º–µ—Ç–æ–¥ getImageData¬ª, color, transparency}}

–í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å `data` –æ–±'—î–∫—Ç–∞, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –º–µ—Ç–æ–¥–æ–º `getImageData`, —î –º–∞—Å–∏–≤–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ –∫–æ–ª—å–æ—Ä—É. –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø—ñ–∫—Å–µ–ª—è —É –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫—É, –∑–∞–¥–∞–Ω–æ–º—É –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, –≤—ñ–Ω –º—ñ—Å—Ç–∏—Ç—å —á–æ—Ç–∏—Ä–∏ –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫—ñ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—å —á–µ—Ä–≤–æ–Ω—É, –∑–µ–ª–µ–Ω—É, —Å–∏–Ω—é —Ç–∞ _((–∞–ª—å—Ñ–∞))_ —Å–∫–ª–∞–¥–æ–≤—ñ –∫–æ–ª—å–æ—Ä—É –ø—ñ–∫—Å–µ–ª—è —É –≤–∏–≥–ª—è–¥—ñ —á–∏—Å–µ–ª –≤—ñ–¥ 0 –¥–æ 255. –ê–ª—å—Ñ–∞-—á–∞—Å—Ç–∏–Ω–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –Ω–µ–ø—Ä–æ–∑–æ—Ä—ñ—Å—Ç—å - –∫–æ–ª–∏ –≤–æ–Ω–∞ –¥–æ—Ä—ñ–≤–Ω—é—î 0, –ø—ñ–∫—Å–µ–ª—å —î –ø–æ–≤–Ω—ñ—Å—Ç—é –ø—Ä–æ–∑–æ—Ä–∏–º, –∞ –∫–æ–ª–∏ 255, –≤—ñ–Ω —î –ø–æ–≤–Ω—ñ—Å—Ç—é –Ω–µ–ø—Ä–æ–∑–æ—Ä–∏–º. –î–ª—è –Ω–∞—à–æ—ó –º–µ—Ç–∏ –º–∏ –º–æ–∂–µ–º–æ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —ó—ó.

{{index ¬´—à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–µ —á–∏—Å–ª–æ¬ª, ¬´–º–µ—Ç–æ–¥ toString¬ª}}

–î–≤—ñ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤—ñ —Ü–∏—Ñ—Ä–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —É –Ω–∞—à–∏—Ö –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è—Ö –∫–æ–ª—å–æ—Ä—ñ–≤, —Ç–æ—á–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –¥—ñ–∞–ø–∞–∑–æ–Ω—É –≤—ñ–¥ 0 –¥–æ 255 - –¥–≤—ñ —Ü–∏—Ñ—Ä–∏ –∑ –æ—Å–Ω–æ–≤–æ—é 16 –º–æ–∂—É—Ç—å –≤–∏—Ä–∞–∂–∞—Ç–∏ 16^2^ = 256 —Ä—ñ–∑–Ω–∏—Ö —á–∏—Å–µ–ª. –ú–µ—Ç–æ–¥ `toString` –¥–ª—è —á–∏—Å–µ–ª –º–æ–∂–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –æ—Å–Ω–æ–≤—É —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç, —Ç–æ–º—É `n.toString(16)` —Å—Ç–≤–æ—Ä–∏—Ç—å —Ä—è–¥–∫–æ–≤–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —É —Å–∏—Å—Ç–µ–º—ñ —á–∏—Å–ª–µ–Ω–Ω—è –∑ –æ—Å–Ω–æ–≤–æ—é 16. –ú–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –∫–æ–∂–Ω–µ —á–∏—Å–ª–æ –∑–∞–π–º–∞—î –¥–≤—ñ —Ü–∏—Ñ—Ä–∏, —Ç–æ–º—É –¥–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è `hex` –≤–∏–∫–ª–∏–∫–∞—î `padStart` –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ 0, –∫–æ–ª–∏ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ.

–¢–µ–ø–µ—Ä –º–∏ –º–æ–∂–µ–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —ñ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏! –ó–∞–ª–∏—à–∏–ª–∞—Å—è –ª–∏—à–µ –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è, —ñ –º–∏ –∑–∞–∫—ñ–Ω—á–∏–º–æ.

## –í—ñ–¥–º—ñ–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—ó

–û—Å–∫—ñ–ª—å–∫–∏ –ø–æ–ª–æ–≤–∏–Ω–∞ –ø—Ä–æ—Ü–µ—Å—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø–æ–ª—è–≥–∞—î —É —Ç–æ–º—É, —â–æ–± —Ä–æ–±–∏—Ç–∏ –º–∞–ª–µ–Ω—å–∫—ñ –ø–æ–º–∏–ª–∫–∏ —ñ –≤–∏–ø—Ä–∞–≤–ª—è—Ç–∏ —ó—Ö, –≤–∞–∂–ª–∏–≤–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é —É –ø—Ä–æ–≥—Ä–∞–º—ñ –¥–ª—è –º–∞–ª—é–≤–∞–Ω–Ω—è —î ((–≤—ñ–¥–º—ñ–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—ó)).

{{index ¬´persistent data structure¬ª, [state, ¬´of application¬ª]}}

–î–ª—è —Ç–æ–≥–æ, —â–æ–± –º–∞—Ç–∏ –∑–º–æ–≥—É —Å–∫–∞—Å—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–∏, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –≤–µ—Ä—Å—ñ—ó –º–∞–ª—é–Ω–∫–∞. –û—Å–∫—ñ–ª—å–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —î ((–Ω–µ–∑–º—ñ–Ω–Ω–∏–º–∏)) –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏, —Ü–µ –ª–µ–≥–∫–æ. –ê–ª–µ —Ü–µ –ø–æ—Ç—Ä–µ–±—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –ø–æ–ª—è —É —Å—Ç–∞–Ω—ñ –¥–æ–¥–∞—Ç–∫—É.

{{index ¬´done property¬ª}}

–ú–∏ –¥–æ–¥–∞–º–æ –º–∞—Å–∏–≤ `done` –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –≤–µ—Ä—Å—ñ–π ((picture)). –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ü—ñ—î—ó –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –≤–∏–º–∞–≥–∞—î –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É, —è–∫–∞ –¥–æ–¥–∞—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ –º–∞—Å–∏–≤—É.

{{index ¬´doneAt property¬ª, ¬´historyUpdateState function¬ª, ¬´Date.now function¬ª}}

–ú–∏ –Ω–µ —Ö–æ—á–µ–º–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ _–∫–æ–∂–Ω—É_ –∑–º—ñ–Ω—É - –ª–∏—à–µ –∑–º—ñ–Ω–∏, —è–∫—ñ –≤—ñ–¥–±—É–≤–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø–µ–≤–Ω–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫ —á–∞—Å—É. –î–ª—è —Ü—å–æ–≥–æ –Ω–∞–º –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥—Ä—É–≥–∞ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å, `doneAt`, —â–æ–± –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ —á–∞—Å, –∫–æ–ª–∏ –º–∏ –≤–æ—Å—Ç–∞–Ω–Ω—î –∑–±–µ—Ä—ñ–≥–∞–ª–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ —ñ—Å—Ç–æ—Ä—ñ—ó.

```{includeCode: true}
function historyUpdateState(state, action) {
  if (action.undo == true) {
    if (state.done.length == 0) return state;
    return {
      ...state,
      picture: state.done[0],
      done: state.done.slice(1),
      doneAt: 0
    };
  } else if (action.picture &&
             state.doneAt < Date.now() - 1000) { } if (state.doneAt < Date.now() - 1000) {
    return {
      ...state,
      ...action,
      done: [state.picture, ...state.done],
      doneAt: Date.now()
    };
  } else {
    return {...state, ...action};
  }
}
```

{{index ¬´undo history¬ª}}

–ö–æ–ª–∏ –¥—ñ—è —î –¥—ñ—î—é —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è, —Ñ—É–Ω–∫—Ü—ñ—è –±–µ—Ä–µ –æ—Å—Ç–∞–Ω–Ω—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ —ñ—Å—Ç–æ—Ä—ñ—ó —ñ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ –ø–æ—Ç–æ—á–Ω–∏–º –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º. –í–æ–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î `doneAt` –≤ –Ω—É–ª—å, —Ç–∞–∫ —â–æ –Ω–∞—Å—Ç—É–ø–Ω–∞ –∑–º—ñ–Ω–∞ –≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ –∑–±–µ—Ä–µ–∂–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–∞–∑–∞–¥ –≤ —ñ—Å—Ç–æ—Ä—ñ—é, —â–æ –¥–æ–∑–≤–æ–ª–∏—Ç—å –≤–∞–º –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –Ω—å–æ–≥–æ —ñ–Ω—à–∏–º —Ä–∞–∑–æ–º, —è–∫—â–æ –≤–∏ –∑–∞—Ö–æ—á–µ—Ç–µ.

–í —ñ–Ω—à–æ–º—É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –¥—ñ—è –º—ñ—Å—Ç–∏—Ç—å –Ω–æ–≤–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –∞ –≤–æ—Å—Ç–∞–Ω–Ω—î –º–∏ –∑–±–µ—Ä—ñ–≥–∞–ª–∏ —â–æ—Å—å –±—ñ–ª—å—à–µ —Å–µ–∫—É–Ω–¥–∏ (1000 –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥) —Ç–æ–º—É, –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ `done` —ñ `doneAt` –±—É–¥–µ –æ–Ω–æ–≤–ª–µ–Ω–æ, —â–æ–± –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è.

{{index ¬´UndoButton class¬ª, control}}

–ö–Ω–æ–ø–∫–∞ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è ((–∫–æ–º–ø–æ–Ω–µ–Ω—Ç)) –Ω–µ —Ä–æ–±–∏—Ç—å –±–∞–≥–∞—Ç–æ —á–æ–≥–æ. –í–æ–Ω–∞ –≤–∏–∫–æ–Ω—É—î –¥—ñ—ó —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ —ñ –≤–∏–º–∏–∫–∞—î—Ç—å—Å—è, –∫–æ–ª–∏ –Ω–µ–º–∞—î —á–æ–≥–æ —Å–∫–∞—Å–æ–≤—É–≤–∞—Ç–∏.

```{includeCode: true}
class UndoButton {
  constructor(state, {dispatch}) {
    this.dom = elt(¬´button¬ª, {
      onclick: () => dispatch({undo: true}),
      disabled: state.done.length == 0
    }, ¬´‚Æ™ –°–∫–∞—Å—É–≤–∞—Ç–∏¬ª);
  }
  syncState(state) {
    this.dom.disabled = state.done.length == 0;
  }
}
```

## –ú–∞–ª—é—î–º–æ

{{index ¬´–∫–ª–∞—Å PixelEditor¬ª, ¬´–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ startState¬ª, ¬´–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ baseTools¬ª, ¬´–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ baseControls¬ª, ¬´—Ñ—É–Ω–∫—Ü—ñ—è startPixelEditor¬ª}}

–©–æ–± –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å—Ç–∞–Ω, –Ω–∞–±—ñ—Ä ((—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤)), –Ω–∞–±—ñ—Ä ((–µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∫–µ—Ä—É–≤–∞–Ω–Ω—è)) —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—é ((–≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è)). –ú–∏ –º–æ–∂–µ–º–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ —ó—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É `PixelEditor` –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥–æ–ª–æ–≤–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞. –û—Å–∫—ñ–ª—å–∫–∏ —É –≤–ø—Ä–∞–≤–∞—Ö –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ–≤, —Å–ø–æ—á–∞—Ç–∫—É –≤–∏–∑–Ω–∞—á–∏–º–æ –¥–µ—è–∫—ñ –ø—Ä–∏–≤'—è–∑–∫–∏.

```{includeCode: true}
const startState = {
  tool: ¬´draw¬ª,
  color: ¬´#000000¬ª,
  picture: Picture.empty(60, 30, ¬´#f0f0f0¬ª),
  done: [],
  doneAt: 0
};

const baseTools = {draw, fill, rectangle, pick};

const baseControls = [
  ToolSelect, ColorSelect, SaveButton, LoadButton, UndoButton
];

function startPixelEditor({state = startState,
                           tools = baseTools,
                           controls = baseControls}) {
  let app = new PixelEditor(state, {
    tools,
    controls,
    dispatch(action) {
      state = historyUpdateState(state, action);
      app.syncState(state);
    }
  });
  return app.dom;
}
```

{{index ¬´destructuring binding¬ª, ¬´= operator¬ª, [property, access]}}

–ü—Ä–∏ –¥–µ—Å—Ç—Ä—É–∫—Ü—ñ—ó –æ–±'—î–∫—Ç–∞ –∞–±–æ –º–∞—Å–∏–≤—É –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `=` –ø—ñ—Å–ª—è —ñ–º–µ–Ω—ñ –ø—Ä–∏–≤'—è–∑–∫–∏, —â–æ–± –Ω–∞–¥–∞—Ç–∏ –ø—Ä–∏–≤'—è–∑—Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è a ((–∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)), —è–∫–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –∫–æ–ª–∏ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –≤—ñ–¥—Å—É—Ç–Ω—è –∞–±–æ –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è `undefined`. –§—É–Ω–∫—Ü—ñ—è `startPixelEditor` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–µ, —â–æ–± –ø—Ä–∏–π–Ω—è—Ç–∏ –æ–±'—î–∫—Ç –∑ –Ω–∏–∑–∫–æ—é –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∏ –Ω–µ –≤–∫–∞–∂–µ—Ç–µ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å `tools`, —Ç–æ `tools` –±—É–¥–µ –ø—Ä–∏–≤'—è–∑–∞–Ω–æ –¥–æ `baseTools`.

–¢–∞–∫–∏–º —á–∏–Ω–æ–º –º–∏ –æ—Ç—Ä–∏–º–∞—î–º–æ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä:

```{lang: html, startCode: true}
<div></div>
<script>
  document.querySelector(¬´div¬ª)
    .appendChild(startPixelEditor({}));
</script>
```

{{—è–∫—â–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π

–ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ –º–∞–ª—é–≤–∞—Ç–∏.

if}}

## –ß–æ–º—É —Ü–µ —Ç–∞–∫ —Å–∫–ª–∞–¥–Ω–æ?

–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è –±—Ä–∞—É–∑–µ—Ä—ñ–≤ –¥–∏–≤–æ–≤–∏–∂–Ω–∞. –í–æ–Ω–∞ –Ω–∞–¥–∞—î –ø–æ—Ç—É–∂–Ω–∏–π –Ω–∞–±—ñ—Ä –±—É–¥—ñ–≤–µ–ª—å–Ω–∏—Ö –±–ª–æ–∫—ñ–≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É, —Å–ø–æ—Å–æ–±—ñ–≤ —Å—Ç–∏–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è –Ω–∏–º–∏, –∞ —Ç–∞–∫–æ–∂ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –≤–∞—à–∏—Ö –ø—Ä–æ–≥—Ä–∞–º. –ü—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è, —è–∫–µ –≤–∏ –ø–∏—à–µ—Ç–µ –¥–ª—è ((–±—Ä–∞—É–∑–µ—Ä–∞)), –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –º–∞–π–∂–µ –Ω–∞ –∫–æ–∂–Ω–æ–º—É –∫–æ–º–ø'—é—Ç–µ—Ä—ñ —Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ –Ω–∞ –ø–ª–∞–Ω–µ—Ç—ñ.

–£ —Ç–æ–π –∂–µ —á–∞—Å, —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è –±—Ä–∞—É–∑–µ—Ä—ñ–≤ –ø—Ä–æ—Å—Ç–æ —Å–º—ñ—à–Ω–∞. –©–æ–± –æ–ø–∞–Ω—É–≤–∞—Ç–∏ —ó—ó, –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–≤—á–∏—Ç–∏ –≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥—É—Ä–Ω–∏—Ö —Ç—Ä—é–∫—ñ–≤ —ñ –Ω–µ–∑—Ä–æ–∑—É–º—ñ–ª–∏—Ö —Ñ–∞–∫—Ç—ñ–≤, –∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –º–æ–¥–µ–ª—å –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —è–∫—É –≤–æ–Ω–∞ –Ω–∞–¥–∞—î, –Ω–∞—Å—Ç—ñ–ª—å–∫–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–∞, —â–æ –±—ñ–ª—å—à—ñ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç—ñ–≤ –≤–≤–∞–∂–∞—é—Ç—å –∑–∞ –∫—Ä–∞—â–µ –ø–æ–∫—Ä–∏—Ç–∏ —ó—ó –∫—ñ–ª—å–∫–æ–º–∞ —à–∞—Ä–∞–º–∏ ((–∞–±—Å—Ç—Ä–∞–∫—Ü—ñ—ó)), –Ω—ñ–∂ –º–∞—Ç–∏ —Å–ø—Ä–∞–≤—É –∑ –Ω–µ—é –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ.

{{—ñ–Ω–¥–µ–∫—Å–Ω–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç, –µ–≤–æ–ª—é—Ü—ñ—è}}

–•–æ—á–∞ —Å–∏—Ç—É–∞—Ü—ñ—è, –±–µ–∑—É–º–æ–≤–Ω–æ, –ø–æ–∫—Ä–∞—â—É—î—Ç—å—Å—è, –∑–¥–µ–±—ñ–ª—å—à–æ–≥–æ —Ü–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —É —Ñ–æ—Ä–º—ñ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –¥–ª—è —É—Å—É–Ω–µ–Ω–Ω—è –Ω–µ–¥–æ–ª—ñ–∫—ñ–≤, —â–æ —Å—Ç–≤–æ—Ä—é—î —â–µ –±—ñ–ª—å—à—É ((—Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å)). –§—É–Ω–∫—Ü—ñ—é, —è–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –º—ñ–ª—å–π–æ–Ω–∏ –≤–µ–±-—Å–∞–π—Ç—ñ–≤, –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –Ω–µ –º–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏. –ù–∞–≤—ñ—Ç—å —è–∫–±–∏ —Ü–µ –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ, –±—É–ª–æ –± –≤–∞–∂–∫–æ –≤–∏—Ä—ñ—à–∏—Ç–∏, —á–∏–º —ó—ó –∑–∞–º—ñ–Ω–∏—Ç–∏.

{{—ñ–Ω–¥–µ–∫—Å ¬´—Å–æ—Ü—ñ–∞–ª—å–Ω—ñ —Ñ–∞–∫—Ç–æ—Ä–∏¬ª, ¬´–µ–∫–æ–Ω–æ–º—ñ—á–Ω—ñ —Ñ–∞–∫—Ç–æ—Ä–∏¬ª, —ñ—Å—Ç–æ—Ä—ñ—è}}

–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –Ω—ñ–∫–æ–ª–∏ –Ω–µ —ñ—Å–Ω—É—é—Ç—å —É –≤–∞–∫—É—É–º—ñ - –º–∏ –æ–±–º–µ–∂–µ–Ω—ñ –Ω–∞—à–∏–º–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏–º–∏, –µ–∫–æ–Ω–æ–º—ñ—á–Ω–∏–º–∏ –π —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏, —è–∫—ñ —ó—Ö —Å—Ç–≤–æ—Ä–∏–ª–∏. –¶–µ –º–æ–∂–µ –¥—Ä–∞—Ç—É–≤–∞—Ç–∏, –∞–ª–µ –∑–∞–≥–∞–ª–æ–º –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—à–µ –Ω–∞–º–∞–≥–∞—Ç–∏—Å—è –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫ –ø—Ä–∞—Ü—é—î _—ñ—Å–Ω—É—é—á–∞_ —Ç–µ—Ö–Ω—ñ—á–Ω–∞ —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—å - —ñ —á–æ–º—É –≤–æ–Ω–∞ —î —Å–∞–º–µ —Ç–∞–∫–æ—é, - –Ω—ñ–∂ –ª—é—Ç—É–≤–∞—Ç–∏ –ø—Ä–æ—Ç–∏ –Ω–µ—ó –∞–±–æ —à—É–∫–∞—Ç–∏ —ñ–Ω—à—É —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—å.

–ù–æ–≤—ñ ((–∞–±—Å—Ç—Ä–∞–∫—Ü—ñ—ó))  –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º–∏. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞ –º–æ–¥–µ–ª—å —ñ —É–≥–æ–¥–∞ ((–ø–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö)), —è–∫—É —è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤ —É —Ü—ñ–π –≥–ª–∞–≤—ñ, —î –≥—Ä—É–±–æ—é —Ñ–æ—Ä–º–æ—é —Ü—å–æ–≥–æ. –Ø–∫ –≤–∂–µ –∑–≥–∞–¥—É–≤–∞–ª–æ—Å—è, —ñ—Å–Ω—É—é—Ç—å –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, —è–∫—ñ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –∑—Ä–æ–±–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±—ñ–ª—å—à –ø—Ä–∏—î–º–Ω–∏–º. –ù–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–Ω—è —Ü—ñ—î—ó —Å—Ç–∞—Ç—Ç—ñ [React] (https://reactjs.org/) —Ç–∞ [Svelte] (https://svelte.dev/) –±—É–ª–∏ –ø–æ–ø—É–ª—è—Ä–Ω–∏–º–∏, –∞–ª–µ —ñ—Å–Ω—É—î —Ü—ñ–ª–∞ –∫—É—Å—Ç–∞—Ä–Ω–∞ —ñ–Ω–¥—É—Å—Ç—Ä—ñ—è —Ç–∞–∫–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—ñ–≤. –Ø–∫—â–æ –≤–∏ –∑–∞—Ü—ñ–∫–∞–≤–ª–µ–Ω—ñ –≤ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—ñ –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤, —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—è –∑ –¥–µ—è–∫–∏–º–∏ –∑ –Ω–∏—Ö, —â–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫ –≤–æ–Ω–∏ –ø—Ä–∞—Ü—é—é—Ç—å —ñ —è–∫—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ –Ω–∞–¥–∞—é—Ç—å.

## –í–ø—Ä–∞–≤–∏

–£ –Ω–∞—à—ñ–π –ø—Ä–æ–≥—Ä–∞–º—ñ –≤—Å–µ —â–µ —î –º—ñ—Å—Ü–µ –¥–ª—è –≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—è. –î–∞–≤–∞–π—Ç–µ –¥–æ–¥–∞–º–æ —â–µ –∫—ñ–ª—å–∫–∞ —Ñ—É–Ω–∫—Ü—ñ–π —É –≤–∏–≥–ª—è–¥—ñ –≤–ø—Ä–∞–≤.

### –ü—Ä–∏–≤'—è–∑–∫–∞ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏

{{index ¬´–ø—Ä–∏–≤'—è–∑–∫–∏ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ (–≤–ø—Ä–∞–≤–∞)¬ª}}

–î–æ–¥–∞–π—Ç–µ ((–∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∞)) –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó –∫–ª–∞–≤—ñ—à –¥–æ –ø—Ä–æ–≥—Ä–∞–º–∏. –ü–µ—Ä—à–∞ –ª—ñ—Ç–µ—Ä–∞ –Ω–∞–∑–≤–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –≤–∏–±–∏—Ä–∞—î —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∞ [ctrl]{–Ω–∞–∑–≤–∞ –∫–ª–∞–≤—ñ—à—ñ}-Z –∞–±–æ [command]{–Ω–∞–∑–≤–∞ –∫–ª–∞–≤—ñ—à—ñ}-Z –∞–∫—Ç–∏–≤—É—î —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è.

{{index ¬´–∫–ª–∞—Å PixelEditor¬ª, ¬´–∞—Ç—Ä–∏–±—É—Ç tabindex¬ª, ¬´—Ñ—É–Ω–∫—Ü—ñ—è elt¬ª, ¬´–ø–æ–¥—ñ—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–ª–∞–≤—ñ—à—ñ¬ª}}

–ó—Ä–æ–±—ñ—Ç—å —Ü–µ, –º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞–≤—à–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `PixelEditor`. –î–æ–¥–∞–π—Ç–µ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å `tabIndex`, —Ä—ñ–≤–Ω—É 0, –¥–æ –æ–±–≥–æ—Ä—Ç–∫–æ–≤–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ `<div>`, —â–æ–± –≤—ñ–Ω –º—ñ–≥ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É ((focus)). –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ _–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å_, —è–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î _–∞—Ç—Ä–∏–±—É—Ç—É_ `tabindex`, –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è `tabIndex` –∑ –≤–µ–ª–∏–∫–æ—ó –ª—ñ—Ç–µ—Ä–∏, –∞ –Ω–∞—à–∞ —Ñ—É–Ω–∫—Ü—ñ—è `elt` –æ—á—ñ–∫—É—î —ñ–º–µ–Ω–∞ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –∫–ª—é—á–æ–≤–∏—Ö –ø–æ–¥—ñ–π –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –Ω–∞ —Ü—å–æ–º—É –µ–ª–µ–º–µ–Ω—Ç—ñ. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∞–º –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –∫–ª–∞—Ü–Ω—É—Ç–∏, —Ç–æ—Ä–∫–Ω—É—Ç–∏—Å—è –∞–±–æ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É –ø—Ä–æ–≥—Ä–∞–º–∏, –ø–µ—Ä—à –Ω—ñ–∂ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –Ω–µ—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏.

{{index ¬´ctrlKey property¬ª, ¬´metaKey property¬ª, ¬´control key¬ª, ¬´command key¬ª}}

–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–Ω—ñ –ø–æ–¥—ñ—ó –º–∞—é—Ç—å –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ `ctrlKey` —Ç–∞ `metaKey` (–¥–ª—è [command]{keyname} –Ω–∞ Mac), –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —è–∫–∏—Ö –º–æ–∂–Ω–∞ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ —É—Ç—Ä–∏–º—É—é—Ç—å—Å—è —Ü—ñ –∫–ª–∞–≤—ñ—à—ñ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏–º–∏.

{{—è–∫—â–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞

```{test: no, lang: html}
<div></div>
<script>
  // –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∫–ª–∞—Å PixelEditor. –†–æ–∑—à–∏—Ä–∏—Ç–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.
  class PixelEditor {
    constructor(state, config) {
      let {tools, controls, dispatch} = config;
      this.state = state;

      this.canvas = new PictureCanvas(state.picture, pos => {
        let tool = tools[this.state.tool];
        let onMove = tool(pos, this.state, dispatch);
        if (onMove) {
          return pos => onMove(pos, this.state, dispatch);
        }
      });
      this.controls = controls.map(
        Control => new Control(state, config));
      this.dom = elt(¬´div¬ª, {}, this.canvas.dom, elt(¬´br¬ª),
                     ...this.controls.reduce(
                       (a, c) => a.concat(¬ª ¬ª, c.dom), []));
    }
    syncState(state) {
      this.state = state;
      this.canvas.syncState(state.picture);
      for (let ctrl of this.controls) ctrl.syncState(state);
    }
  }

  document.querySelector(¬´div¬ª)
    .appendChild(startPixelEditor({}));
</script>
```

if}}

{{hint

{{index ¬´–ø—Ä–∏–≤'—è–∑–∫–∞ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ (–≤–ø—Ä–∞–≤–∞)¬ª, ¬´–≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –∫–ª–∞–≤—ñ—à—ñ¬ª, ¬´–∫–ª–∞–≤—ñ—à–∞ shift¬ª}}

–í–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—é `key` –ø–æ–¥—ñ–π –¥–ª—è –ª—ñ—Ç–µ—Ä–Ω–∏—Ö –∫–ª–∞–≤—ñ—à –±—É–¥–µ —Å–∞–º–∞ –º–∞–ª–∞ –ª—ñ—Ç–µ—Ä–∞, —è–∫—â–æ [shift]{–Ω–∞–∑–≤–∞ –∫–ª–∞–≤—ñ—à—ñ} –Ω–µ —É—Ç—Ä–∏–º—É—î—Ç—å—Å—è. –ù–∞—Å —Ç—É—Ç –Ω–µ —Ü—ñ–∫–∞–≤–ª—è—Ç—å –ø–æ–¥—ñ—ó –∫–ª–∞–≤—ñ—à –∑ [shift]{—ñ–º'—è_–∫–ª–∞–≤—ñ—à—ñ}.

{{index ¬´keydown event¬ª}}

–û–±—Ä–æ–±–Ω–∏–∫ `¬´keydown¬ª` –º–æ–∂–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–±'—î–∫—Ç –ø–æ–¥—ñ—ó, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏, —á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤—ñ–Ω –∂–æ–¥–Ω–æ–º—É –∑—ñ —Å–ø–æ–ª—É—á–µ–Ω—å –∫–ª–∞–≤—ñ—à. –í–∏ –º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–µ—Ä—à–∏—Ö –ª—ñ—Ç–µ—Ä –∑ –æ–±'—î–∫—Ç–∞ `tools`, —â–æ–± –≤–∞–º –Ω–µ –¥–æ–≤–µ–ª–æ—Å—è —ó—Ö –≤–∏–ø–∏—Å—É–≤–∞—Ç–∏.

{{index ¬´preventDefault method¬ª}}

–ö–æ–ª–∏ –∫–ª—é—á–æ–≤–∞ –ø–æ–¥—ñ—è –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ —è—Ä–ª–∏–∫–æ–º, –≤–∏–∫–ª–∏—á—Ç–µ –¥–ª—è –Ω—å–æ–≥–æ –º–µ—Ç–æ–¥ `preventDefault` —ñ ((–≤—ñ–¥–ø—Ä–∞–≤—Ç–µ)) –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –¥—ñ—é.

–ø—ñ–¥–∫–∞–∑–∫–∞}}

### –ï—Ñ–µ–∫—Ç–∏–≤–Ω–µ –º–∞–ª—é–≤–∞–Ω–Ω—è

{{index ¬´–µ—Ñ–µ–∫—Ç–∏–≤–Ω–µ –º–∞–ª—é–≤–∞–Ω–Ω—è (–≤–ø—Ä–∞–≤–∞)¬ª, ¬´–ø–æ–ª–æ—Ç–Ω–æ (—Ç–µ–≥ HTML)¬ª, efficiency}}

–ü—ñ–¥ —á–∞—Å –º–∞–ª—é–≤–∞–Ω–Ω—è –±—ñ–ª—å—à—ñ—Å—Ç—å —Ä–æ–±–æ—Ç–∏, —è–∫—É –≤–∏–∫–æ–Ω—É—î –Ω–∞—à –¥–æ–¥–∞—Ç–æ–∫, –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —É `drawPicture`. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Å—Ç–∞–Ω—É —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ—à—Ç–∏ DOM –Ω–µ —î –¥—É–∂–µ –¥–æ—Ä–æ–≥–∏–º, –∞–ª–µ –ø–µ—Ä–µ–º–∞–ª—å–æ–≤—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –ø—ñ–∫—Å–µ–ª—ñ–≤ –Ω–∞ –ø–æ–ª–æ—Ç–Ω—ñ —î –¥–æ—Å–∏—Ç—å —Å–∫–ª–∞–¥–Ω–∏–º –∑–∞–≤–¥–∞–Ω–Ω—è–º.

{{index ¬´syncState method¬ª, ¬´PictureCanvas class¬ª}}

–ó–Ω–∞–π–¥—ñ—Ç—å —Å–ø–æ—Å—ñ–± –∑—Ä–æ–±–∏—Ç–∏ –º–µ—Ç–æ–¥ `—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó` –∫–ª–∞—Å—É `PictureCanvas` —à–≤–∏–¥—à–∏–º, –ø–µ—Ä–µ–º–∞–ª—å–æ–≤—É—é—á–∏ –ª–∏—à–µ —Ç—ñ –ø—ñ–∫—Å–µ–ª—ñ, —è–∫—ñ –¥—ñ–π—Å–Ω–æ –∑–º—ñ–Ω–∏–ª–∏—Å—è.

{{index ¬´drawPicture function¬ª, compatibility}}

–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ `drawPicture` —Ç–∞–∫–æ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∫–Ω–æ–ø–∫–æ—é –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è, —Ç–æ–º—É —è–∫—â–æ –≤–∏ –∑–º—ñ–Ω—é—î—Ç–µ —ó—ó, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –∑–º—ñ–Ω–∏ –Ω–µ –ø–æ—Ä—É—à—É—é—Ç—å —Å—Ç–∞—Ä–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è, –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –∑ —ñ–Ω—à–æ—é –Ω–∞–∑–≤–æ—é.

{{index ¬´width property¬ª, ¬´height property¬ª}}

–¢–∞–∫–æ–∂ –∑–∞—É–≤–∞–∂—Ç–µ, —â–æ –∑–º—ñ–Ω–∞ —Ä–æ–∑–º—ñ—Ä—É –µ–ª–µ–º–µ–Ω—Ç–∞ `<canvas>` —à–ª—è—Ö–æ–º –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –π–æ–≥–æ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π `width` –∞–±–æ `height` –æ—á–∏—â–∞—î –π–æ–≥–æ, —Ä–æ–±–ª—è—á–∏ –π–æ–≥–æ –∑–Ω–æ–≤—É –ø–æ–≤–Ω—ñ—Å—Ç—é –ø—Ä–æ–∑–æ—Ä–∏–º.

{{—è–∫—â–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π

```{test: no, lang: html}
<div></div>
<script>
  // –ó–º—ñ–Ω—ñ—Ç—å —Ü–µ–π –º–µ—Ç–æ–¥
  PictureCanvas.prototype.syncState = function(picture) {
    if (this.picture == picture) return;
    this.picture = picture;
    drawPicture(this.picture, this.dom, scale);
  };

  // –ú–æ–∂–ª–∏–≤–æ, –≤–∏ —Ç–∞–∫–æ–∂ –∑–∞—Ö–æ—á–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∞–±–æ –∑–º—ñ–Ω–∏—Ç–∏ —Ü–µ
  —Ñ—É–Ω–∫—Ü—ñ—è drawPicture(picture, canvas, scale) {
    canvas.width = picture.width * scale;
    canvas.height = picture.height * scale;
    let cx = canvas.getContext(¬´2d¬ª);

    for (let y = 0; y < picture.height; y++) {
      for (let x = 0; x < picture.width; x++) {
        cx.fillStyle = picture.pixel(x, y);
        cx.fillRect(x * scale, y * scale, scale, scale);
      }
    }
  }

  document.querySelector(¬´div¬ª)
    .appendChild(startPixelEditor({}));
</script>
```

if}}

{{hint

{{index ¬´–µ—Ñ–µ–∫—Ç–∏–≤–Ω–µ –º–∞–ª—é–≤–∞–Ω–Ω—è (–≤–ø—Ä–∞–≤–∞)¬ª}}

–¶—è –≤–ø—Ä–∞–≤–∞ —î –≥–∞—Ä–Ω–∏–º –ø—Ä–∏–∫–ª–∞–¥–æ–º —Ç–æ–≥–æ, —è–∫ ((–Ω–µ–∑–º—ñ–Ω–Ω—ñ)) —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∞–Ω–∏—Ö –º–æ–∂—É—Ç—å –∑—Ä–æ–±–∏—Ç–∏ –∫–æ–¥ _—à–≤–∏–¥—à–∏–º_. –û—Å–∫—ñ–ª—å–∫–∏ —É –Ω–∞—Å —î —Å—Ç–∞—Ä–µ —ñ –Ω–æ–≤–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –º–∏ –º–æ–∂–µ–º–æ –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ —ó—Ö —ñ –ø–µ—Ä–µ–º–∞–ª—é–≤–∞—Ç–∏ –ª–∏—à–µ —Ç—ñ –ø—ñ–∫—Å–µ–ª—ñ, —â–æ –∑–º—ñ–Ω–∏–ª–∏ –∫–æ–ª—ñ—Ä, –∑–∞–æ—â–∞–¥–∏–≤—à–∏ —É –±—ñ–ª—å—à–æ—Å—Ç—ñ –≤–∏–ø–∞–¥–∫—ñ–≤ –ø–æ–Ω–∞–¥ 99 –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ —Ä–æ–±–æ—Ç–∏ –∑ –º–∞–ª—é–≤–∞–Ω–Ω—è.

{{index ¬´drawPicture function¬ª}}

–í–∏ –º–æ–∂–µ—Ç–µ –∞–±–æ –Ω–∞–ø–∏—Å–∞—Ç–∏ –Ω–æ–≤—É —Ñ—É–Ω–∫—Ü—ñ—é `updatePicture`, –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é `drawPicture` –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–∏–º –∞–±–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º. –î–ª—è –∫–æ–∂–Ω–æ–≥–æ ((–ø—ñ–∫—Å–µ–ª—è)) —Ñ—É–Ω–∫—Ü—ñ—è –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –±—É–ª–æ –ø–µ—Ä–µ–¥–∞–Ω–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ —Ç–∞–∫–∏–º —Å–∞–º–∏–º –∫–æ–ª—å–æ—Ä–æ–º —É —Ü—ñ–π –ø–æ–∑–∏—Ü—ñ—ó, —ñ –ø—Ä–æ–ø—É—Å–∫–∞—î –ø—ñ–∫—Å–µ–ª—å, —è–∫—â–æ —Ü–µ —Ç–∞–∫.

{{index ¬´width property¬ª, ¬´height property¬ª, ¬´canvas (HTML tag)¬ª}}

–û—Å–∫—ñ–ª—å–∫–∏ –ø–æ–ª–æ—Ç–Ω–æ –æ—á–∏—â—É—î—Ç—å—Å—è, –∫–æ–ª–∏ –º–∏ –∑–º—ñ–Ω—é—î–º–æ –π–æ–≥–æ —Ä–æ–∑–º—ñ—Ä, –≤–∞–º —Ç–∞–∫–æ–∂ —Å–ª—ñ–¥ —É–Ω–∏–∫–∞—Ç–∏ –∑–º—ñ–Ω–∏ –π–æ–≥–æ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π `width` —ñ `height`, –∫–æ–ª–∏ —Å—Ç–∞—Ä–µ —ñ –Ω–æ–≤–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –º–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä. –Ø–∫—â–æ –≤–æ–Ω–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è, —â–æ —Å—Ç–∞–Ω–µ—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –≤–∏ –º–æ–∂–µ—Ç–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø—Ä–∏–≤'—è–∑–∫—É, —è–∫–∞ —É—Ç—Ä–∏–º—É—î —Å—Ç–∞—Ä–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –Ω–∞ `null` –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ —Ä–æ–∑–º—ñ—Ä—É –ø–æ–ª–æ—Ç–Ω–∞, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –∂–æ–¥–Ω–æ–≥–æ –ø—ñ–∫—Å–µ–ª—è –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ —Ä–æ–∑–º—ñ—Ä—É –ø–æ–ª–æ—Ç–Ω–∞.

–ø—ñ–¥–∫–∞–∑–∫–∞}}

### –ö–æ–ª–∞

{{—ñ–Ω–¥–µ–∫—Å ¬´–∫–æ–ª–∞ (–≤–ø—Ä–∞–≤–∞)¬ª, –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è}}

–í–∏–∑–Ω–∞—á—Ç–µ ((—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)) –∑ –Ω–∞–∑–≤–æ—é `circle`, —è–∫–∏–π –º–∞–ª—é—î –∑–∞—Ñ–∞—Ä–±–æ–≤–∞–Ω–µ –∫–æ–ª–æ –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è. –¶–µ–Ω—Ç—Ä –∫–æ–ª–∞ –ª–µ–∂–∏—Ç—å —É —Ç–æ—á—Ü—ñ, –¥–µ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è, –∞ –π–æ–≥–æ ((—Ä–∞–¥—ñ—É—Å)) –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –≤—ñ–¥—Å—Ç–∞–Ω–Ω—é, –Ω–∞ —è–∫—É –ø–µ—Ä–µ—Ç—è–≥—É—î—Ç—å—Å—è.

{{—è–∫—â–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ

```{test: no, lang: html}
<div></div>
<script>
  function circle(pos, state, dispatch) {
    // –í–∞—à –∫–æ–¥ —Ç—É—Ç
  }

  let dom = startPixelEditor({
    tools: {...baseTools, circle}
  });
  document.querySelector(¬´div¬ª).appendChild(dom);
</script>
```

if}}

{{hint

{{index ¬´–∫–æ–ª–∞ (–≤–ø—Ä–∞–≤–∞)¬ª, ¬´—Ñ—É–Ω–∫—Ü—ñ—è –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫–∞¬ª}}

–í–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥–∏—Ö–Ω—É—Ç–∏—Å—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º ``–ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫``. –Ø–∫ —ñ —É –≤–∏–ø–∞–¥–∫—É –∑ —Ü–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º, –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞ –≤–∞–º —Å–ª—ñ–¥ –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ –º–∞–ª—é–≤–∞—Ç–∏ –Ω–∞ _–ø–æ—á–∞—Ç–∫–æ–≤–æ–º—É_ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ, –∞ –Ω–µ –Ω–∞ –ø–æ—Ç–æ—á–Ω–æ–º—É.

–©–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —è–∫—ñ –ø—ñ–∫—Å–µ–ª—ñ –∑–∞—Ñ–∞—Ä–±–æ–≤—É–≤–∞—Ç–∏, –º–æ–∂–Ω–∞ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ç–µ–æ—Ä–µ–º–æ—é –ü—ñ—Ñ–∞–≥–æ—Ä–∞. –°–ø–æ—á–∞—Ç–∫—É –æ–±—á–∏—Å–ª—ñ—Ç—å –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ –ø–æ—Ç–æ—á–Ω–∏–º –ø–æ–ª–æ–∂–µ–Ω–Ω—è–º –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞ —ñ –ø–æ—á–∞—Ç–∫–æ–≤–∏–º –ø–æ–ª–æ–∂–µ–Ω–Ω—è–º, –≤–∑—è–≤—à–∏ –∫–≤–∞–¥—Ä–∞—Ç–Ω–∏–π –∫–æ—Ä—ñ–Ω—å (`Math.sqrt`) –∑ —Å—É–º–∏ –∫–≤–∞–¥—Ä–∞—Ç–∞ (`x ** 2`) —Ä—ñ–∑–Ω–∏—Ü—ñ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö x —ñ –∫–≤–∞–¥—Ä–∞—Ç–∞ —Ä—ñ–∑–Ω–∏—Ü—ñ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö y. –ü–æ—Ç—ñ–º –æ–±–≤–µ–¥—ñ—Ç—å –∫–≤–∞–¥—Ä–∞—Ç –ø—ñ–∫—Å–µ–ª—ñ–≤ –Ω–∞–≤–∫–æ–ª–æ –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó –ø–æ–∑–∏—Ü—ñ—ó, —Å—Ç–æ—Ä–æ–Ω–∏ —è–∫–æ–≥–æ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –≤–¥–≤—ñ—á—ñ –ø–µ—Ä–µ–≤–∏—â—É—é—Ç—å ((—Ä–∞–¥—ñ—É—Å)), —ñ –∑–∞—Ñ–∞—Ä–±—É–π—Ç–µ —Ç—ñ, —â–æ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ –º–µ–∂–∞—Ö —Ä–∞–¥—ñ—É—Å–∞ –∫–æ–ª–∞, –∑–Ω–æ–≤—É –∂ —Ç–∞–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ–æ—Ä–º—É–ª—É –ü—ñ—Ñ–∞–≥–æ—Ä–∞, —â–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —ó—Ö–Ω—é ((–≤—ñ–¥—Å—Ç–∞–Ω—å)) –≤—ñ–¥ —Ü–µ–Ω—Ç—Ä—É.

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ –Ω–µ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –∑–∞—Ñ–∞—Ä–±—É–≤–∞—Ç–∏ –ø—ñ–∫—Å–µ–ª—ñ, —è–∫—ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –∑–∞ –º–µ–∂–∞–º–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è.

–ø—ñ–¥–∫–∞–∑–∫–∞}}

### –í–ª–∞—Å–Ω—ñ –ª—ñ–Ω—ñ—ó

{{index ¬´–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –ª—ñ–Ω—ñ—ó (–≤–ø—Ä–∞–≤–∞)¬ª, ¬´–º–∞–ª—é–≤–∞–Ω–Ω—è –ª—ñ–Ω—ñ–π¬ª}}

–¶—è –≤–ø—Ä–∞–≤–∞ —î –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–æ—é, –Ω—ñ–∂ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ —Ç—Ä–∏, —ñ –≤–∏–º–∞–≥–∞—Ç–∏–º–µ –≤—ñ–¥ –≤–∞—Å —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è –Ω–µ—Ç—Ä–∏–≤—ñ–∞–ª—å–Ω–æ—ó –∑–∞–¥–∞—á—ñ. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —É –≤–∞—Å –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —á–∞—Å—É —ñ —Ç–µ—Ä–ø—ñ–Ω–Ω—è –ø–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º —Ä–æ–±–æ—Ç–∏ –Ω–∞–¥ —Ü—ñ—î—é –≤–ø—Ä–∞–≤–æ—é, —ñ –Ω–µ –ø–∞–¥–∞–π—Ç–µ –¥—É—Ö–æ–º —á–µ—Ä–µ–∑ –ø–µ—Ä—à—ñ –Ω–µ–≤–¥–∞—á—ñ.

{{index ¬´draw function¬ª, ¬´mousemove event¬ª, ¬´touchmove event¬ª}}

–£ –±—ñ–ª—å—à–æ—Å—Ç—ñ –±—Ä–∞—É–∑–µ—Ä—ñ–≤, –∫–æ–ª–∏ –≤–∏ –≤–∏–±–∏—Ä–∞—î—Ç–µ `draw` (—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–∞–ª—é–≤–∞–Ω–Ω—è) —ñ —à–≤–∏–¥–∫–æ –ø–µ—Ä–µ—Ç—è–≥—É—î—Ç–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –≤–∏ –Ω–µ –æ—Ç—Ä–∏–º—É—î—Ç–µ –∑–∞–º–∫–Ω–µ–Ω—É –ª—ñ–Ω—ñ—é. –°–∫–æ—Ä—ñ—à–µ, –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –∫—Ä–∞–ø–∫–∏ –∑ –ø—Ä–æ–º—ñ–∂–∫–∞–º–∏ –º—ñ–∂ –Ω–∏–º–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –ø–æ–¥—ñ—ó `mousemove` –∞–±–æ `touchmove` –Ω–µ —Å–ø—Ä–∞—Ü—é–≤–∞–ª–∏ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —à–≤–∏–¥–∫–æ, —â–æ–± –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –¥–æ –∫–æ–∂–Ω–æ–≥–æ –ø—ñ–∫—Å–µ–ª—è ((–ø—ñ–∫—Å–µ–ª—è)).

–í–¥–æ—Å–∫–æ–Ω–∞–ª–∏—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `draw`, —â–æ–± –≤—ñ–Ω –º–∞–ª—é–≤–∞–≤ –ø–æ–≤–Ω—É –ª—ñ–Ω—ñ—é. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—É—Å–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –æ–±—Ä–æ–±–Ω–∏–∫–∞ —Ä—É—Ö—É –∑–∞–ø–∞–º'—è—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—é –ø–æ–∑–∏—Ü—ñ—é —ñ –ø–æ–≤'—è–∑—É–≤–∞—Ç–∏ —ó—ó –∑ –ø–æ—Ç–æ—á–Ω–æ—é.

–î–ª—è —Ü—å–æ–≥–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –ø—ñ–∫—Å–µ–ª—ñ –º–æ–∂—É—Ç—å –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏—Å—è –Ω–∞ –¥–æ–≤—ñ–ª—å–Ω—ñ–π –≤—ñ–¥—Å—Ç–∞–Ω—ñ –æ–¥–∏–Ω –≤—ñ–¥ –æ–¥–Ω–æ–≥–æ, –≤–∞–º –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –Ω–∞–ø–∏—Å–∞—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é –º–∞–ª—é–≤–∞–Ω–Ω—è –ª—ñ–Ω—ñ—ó.

–õ—ñ–Ω—ñ—è –º—ñ–∂ –¥–≤–æ–º–∞ –ø—ñ–∫—Å–µ–ª—è–º–∏ - —Ü–µ –∑'—î–¥–Ω–∞–Ω–∏–π –ª–∞–Ω—Ü—é–∂–æ–∫ –ø—ñ–∫—Å–µ–ª—ñ–≤, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä—è–º–∏–π, —â–æ –π–¥–µ –≤—ñ–¥ –ø–æ—á–∞—Ç–∫—É –¥–æ –∫—ñ–Ω—Ü—è. –°—É—Å—ñ–¥–Ω—ñ –ø–æ –¥—ñ–∞–≥–æ–Ω–∞–ª—ñ –ø—ñ–∫—Å–µ–ª—ñ –≤–≤–∞–∂–∞—é—Ç—å—Å—è –∑'—î–¥–Ω–∞–Ω–∏–º–∏. –ù–∞—Ö–∏–ª–µ–Ω–∞ –ª—ñ–Ω—ñ—è –º–∞—î –≤–∏–≥–ª—è–¥–∞—Ç–∏ —è–∫ –Ω–∞ –º–∞–ª—é–Ω–∫—É –ª—ñ–≤–æ—Ä—É—á, –∞ –Ω–µ —è–∫ –Ω–∞ –º–∞–ª—é–Ω–∫—É –ø—Ä–∞–≤–æ—Ä—É—á.

{{figure {url: ¬´img/line-grid.svg¬ª, alt: ¬´–î—ñ–∞–≥—Ä–∞–º–∞ –∑ –¥–≤–æ—Ö –ø—ñ–∫—Å–µ–ª—å–Ω–∏—Ö –ª—ñ–Ω—ñ–π, –æ–¥–Ω—ñ—î—ó –ª–µ–≥–∫–æ—ó, —â–æ –ø—Ä–æ–ø—É—Å–∫–∞—î –ø—ñ–∫—Å–µ–ª—ñ –ø–æ –¥—ñ–∞–≥–æ–Ω–∞–ª—ñ, —ñ –æ–¥–Ω—ñ—î—ó –≤–∞–∂–∫–æ—ó, –∑ —É—Å—ñ–º–∞ –ø—ñ–∫—Å–µ–ª—è–º–∏, –∑'—î–¥–Ω–∞–Ω–∏–º–∏ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—ñ –∞–±–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—ñ¬ª, width: ‚Äú6cm‚Äù}}}.

–ù–∞—Ä–µ—à—Ç—ñ, —è–∫—â–æ —É –Ω–∞—Å —î –∫–æ–¥, —è–∫–∏–π –º–∞–ª—é—î –ª—ñ–Ω—ñ—é –º—ñ–∂ –¥–≤–æ–º–∞ –¥–æ–≤—ñ–ª—å–Ω–∏–º–∏ —Ç–æ—á–∫–∞–º–∏, –º–∏ –º–æ–∂–µ–º–æ —Ç–∞–∫–æ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ `line`, —è–∫–∏–π –º–∞–ª—é—î –ø—Ä—è–º—É –ª—ñ–Ω—ñ—é –º—ñ–∂ –ø–æ—á–∞—Ç–∫–æ–º —ñ –∫—ñ–Ω—Ü–µ–º –ø–µ—Ä–µ—Ç—è–≥—É–≤–∞–Ω–Ω—è.

{{—è–∫—â–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ

```{test: no, lang: html}
<div></div>
<script>
  // –°—Ç–∞—Ä–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–∞–ª—é–≤–∞–Ω–Ω—è. –ü–µ—Ä–µ–ø–∏—à—ñ—Ç—å —Ü–µ.
  function draw(pos, state, dispatch) {
    function drawPixel({x, y}, state) {
      let drawn = {x, y, color: state.color};
      dispatch({picture: state.picture.draw([drawn])});
    }
    drawPixel(pos, state);
    return drawPixel;
  }

  function line(pos, state, dispatch) {
    // –í–∞—à –∫–æ–¥ —Ç—É—Ç
  }

  let dom = startPixelEditor({
    tools: {draw, line, fill, rectangle, pick}
  });
  document.querySelector(¬´div¬ª).appendChild(dom);
</script>
```

if}}

{{hint

{{index ¬´–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –ª—ñ–Ω—ñ—ó (–≤–ø—Ä–∞–≤–∞)¬ª, ¬´–º–∞–ª—é–≤–∞–Ω–Ω—è –ª—ñ–Ω—ñ–π¬ª}}

–°–ø—Ä–∞–≤–∞ —É —Ç–æ–º—É, —â–æ –ø—Ä–æ–±–ª–µ–º–∞ –º–∞–ª—é–≤–∞–Ω–Ω—è –ø—ñ–∫—Å–µ–ª—å–Ω–æ—ó –ª—ñ–Ω—ñ—ó –ø–æ–ª—è–≥–∞—î —É —Ç–æ–º—É, —â–æ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ —Ü–µ —á–æ—Ç–∏—Ä–∏ —Å—Ö–æ–∂—ñ, –∞–ª–µ –¥–µ—â–æ –≤—ñ–¥–º—ñ–Ω–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏. –ù–∞–º–∞–ª—é–≤–∞—Ç–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É –ª—ñ–Ω—ñ—é –∑–ª—ñ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ –¥—É–∂–µ –ø—Ä–æ—Å—Ç–æ - –≤–∏ –æ–±—Ö–æ–¥–∏—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ x —ñ –∑–∞—Ñ–∞—Ä–±–æ–≤—É—î—Ç–µ –ø—ñ–∫—Å–µ–ª—å –Ω–∞ –∫–æ–∂–Ω–æ–º—É –∫—Ä–æ—Ü—ñ. –Ø–∫—â–æ –ª—ñ–Ω—ñ—è –º–∞—î –Ω–µ–≤–µ–ª–∏–∫–∏–π –Ω–∞—Ö–∏–ª (–º–µ–Ω—à–µ 45 –≥—Ä–∞–¥—É—Å—ñ–≤ –∞–±–æ ¬ºœÄ —Ä–∞–¥—ñ–∞–Ω–∞), –≤–∏ –º–æ–∂–µ—Ç–µ —ñ–Ω—Ç–µ—Ä–ø–æ–ª—é–≤–∞—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É y –≤–∑–¥–æ–≤–∂ –Ω–∞—Ö–∏–ª—É. –í–∞–º –≤—Å–µ –æ–¥–Ω–æ –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –æ–¥–∏–Ω –ø—ñ–∫—Å–µ–ª—å –Ω–∞ –ø–æ–∑–∏—Ü—ñ—é _x_, –∞ –ø–æ–∑–∏—Ü—ñ—è _y_ —Ü–∏—Ö –ø—ñ–∫—Å–µ–ª—ñ–≤ –≤–∏–∑–Ω–∞—á–∞—Ç–∏–º–µ—Ç—å—Å—è –Ω–∞—Ö–∏–ª–æ–º.

–ê–ª–µ —è–∫ —Ç—ñ–ª—å–∫–∏ –Ω–∞—Ö–∏–ª –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ 45 –≥—Ä–∞–¥—É—Å—ñ–≤, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—ñ–Ω–∏—Ç–∏ —Å–ø–æ—Å—ñ–± –æ–±—Ä–æ–±–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç. –¢–µ–ø–µ—Ä –≤–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω –æ–¥–∏–Ω –ø—ñ–∫—Å–µ–ª—å –Ω–∞ –ø–æ–∑–∏—Ü—ñ—é _y_, –æ—Å–∫—ñ–ª—å–∫–∏ –ª—ñ–Ω—ñ—è –π–¥–µ –≤–≥–æ—Ä—É –±—ñ–ª—å—à–µ, –Ω—ñ–∂ –≤–ª—ñ–≤–æ. –ê –ø–æ—Ç—ñ–º, –∫–æ–ª–∏ –≤–∏ –ø–µ—Ä–µ—Ç–∏–Ω–∞—î—Ç–µ 135 –≥—Ä–∞–¥—É—Å—ñ–≤, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Ü–∏–∫–ª—É –Ω–∞–¥ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ x, –∞–ª–µ —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª—ñ–≤–æ.

–ù–∞—Å–ø—Ä–∞–≤–¥—ñ –≤–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–∏—Å–∞—Ç–∏ —á–æ—Ç–∏—Ä–∏ —Ü–∏–∫–ª–∏. –û—Å–∫—ñ–ª—å–∫–∏ –Ω–∞–º–∞–ª—é–≤–∞—Ç–∏ –ª—ñ–Ω—ñ—é –≤—ñ–¥ _A_ –¥–æ _B_ - —Ü–µ —Ç–µ —Å–∞–º–µ, —â–æ –Ω–∞–º–∞–ª—é–≤–∞—Ç–∏ –ª—ñ–Ω—ñ—é –≤—ñ–¥ _B_ –¥–æ _A_, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–º—ñ–Ω—è—Ç–∏ –º—ñ—Å—Ü—è–º–∏ –ø–æ—á–∞—Ç–∫–æ–≤—É —ñ –∫—ñ–Ω—Ü–µ–≤—É –ø–æ–∑–∏—Ü—ñ—ó –¥–ª—è –ª—ñ–Ω—ñ–π, —â–æ –π–¥—É—Ç—å —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª—ñ–≤–æ, —ñ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏ —ó—Ö —è–∫ —Ç–∞–∫—ñ, —â–æ –π–¥—É—Ç—å –∑–ª—ñ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ.

–û—Ç–∂–µ, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–≤–∞ —Ä—ñ–∑–Ω–∏—Ö —Ü–∏–∫–ª–∏. –ü–µ—Ä—à–µ, —â–æ –º–∞—î –∑—Ä–æ–±–∏—Ç–∏ –≤–∞—à–∞ —Ñ—É–Ω–∫—Ü—ñ—è –º–∞–ª—é–≤–∞–Ω–Ω—è –ª—ñ–Ω—ñ–π, —Ü–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ x-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –±—ñ–ª—å—à–∞ –∑–∞ —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ y-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏. –Ø–∫—â–æ —Ç–∞–∫, —Ç–æ —Ü–µ –±—É–¥–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞ –ª—ñ–Ω—ñ—è, –∞ —è–∫—â–æ –Ω—ñ, —Ç–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞.

{{index ¬´Math.abs function¬ª, ¬´–∞–±—Å–æ–ª—é—Ç–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è¬ª}}

–û–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–æ—Ä—ñ–≤–Ω—é–π—Ç–µ _–∞–±—Å–æ–ª—é—Ç–Ω—ñ_ –∑–Ω–∞—á–µ–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ü—ñ _x_ —Ç–∞ _y_, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `Math.abs`.

{{index ¬´swapping bindings¬ª}}

–ö–æ–ª–∏ –≤–∏ –∑–Ω–∞—î—Ç–µ, –≤–∑–¥–æ–≤–∂ —è–∫–æ—ó ((–æ—Å—ñ)) –≤–∏ –±—É–¥–µ—Ç–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ü–∏–∫–ª, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∞ —Ç–æ—á–∫–∞ –º–∞—î –≤–∏—â—É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É –≤–∑–¥–æ–≤–∂ —Ü—ñ—î—ó –æ—Å—ñ, –Ω—ñ–∂ –∫—ñ–Ω—Ü–µ–≤–∞, —ñ –ø–æ–º—ñ–Ω—è—Ç–∏ —ó—Ö –º—ñ—Å—Ü—è–º–∏, —è–∫—â–æ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ. –õ–∞–∫–æ–Ω—ñ—á–Ω–∏–π —Å–ø–æ—Å—ñ–± –ø–æ–º—ñ–Ω—è—Ç–∏ –º—ñ—Å—Ü—è–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–≤–æ—Ö –ø—Ä–∏–≤'—è–∑–æ–∫ —É JavaScript –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î ((–¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–∏—Å–≤–æ—î–Ω–Ω—è)) —Ç–∞–∫–∏–º —á–∏–Ω–æ–º:

```{test: no}
[start, end] = [end, start];
```

{{–æ–∫—Ä—É–≥–ª–µ–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É}}

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤–∏ –º–æ–∂–µ—Ç–µ –æ–±—á–∏—Å–ª–∏—Ç–∏ ((–Ω–∞—Ö–∏–ª)) –ª—ñ–Ω—ñ—ó, —è–∫–∏–π –≤–∏–∑–Ω–∞—á–∞—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –Ω–∞ —ñ–Ω—à—ñ–π –æ—Å—ñ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–æ–∫—É, —è–∫–∏–π –≤–∏ —Ä–æ–±–∏—Ç–µ –≤–∑–¥–æ–≤–∂ –≥–æ–ª–æ–≤–Ω–æ—ó –æ—Å—ñ. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü–∏–∫–ª –≤–∑–¥–æ–≤–∂ –≥–æ–ª–æ–≤–Ω–æ—ó –æ—Å—ñ, –æ–¥–Ω–æ—á–∞—Å–Ω–æ –≤—ñ–¥—Å—Ç–µ–∂—É—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –ø–æ–∑–∏—Ü—ñ—é –Ω–∞ —ñ–Ω—à—ñ–π –æ—Å—ñ, —ñ –≤–∏ –º–æ–∂–µ—Ç–µ –º–∞–ª—é–≤–∞—Ç–∏ –ø—ñ–∫—Å–µ–ª—ñ –Ω–∞ –∫–æ–∂–Ω—ñ–π —ñ—Ç–µ—Ä–∞—Ü—ñ—ó. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ –æ–∫—Ä—É–≥–ª—é—î—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –Ω–µ–æ—Å–Ω–æ–≤–Ω–æ—ó –æ—Å—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –¥—Ä–æ–±–æ–≤–∏–º–∏, –∞ –º–µ—Ç–æ–¥ `draw` –ø–æ–≥–∞–Ω–æ —Ä–µ–∞–≥—É—î –Ω–∞ –¥—Ä–æ–±–æ–≤—ñ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏.

–ø—ñ–¥–∫–∞–∑–∫–∞}}
